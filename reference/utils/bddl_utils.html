
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="asset_utils.html">
      
      
        <link rel="next" href="config_utils.html">
      
      <link rel="icon" href="../../assets/OmniGibson_logo.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>bddl_utils - OmniGibson Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-6L1G6GMR63"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-6L1G6GMR63",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-6L1G6GMR63",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#bddl_utils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="OmniGibson Documentation" class="md-header__button md-logo" aria-label="OmniGibson Documentation" data-md-component="logo">
      
  <img src="../../assets/OmniGibson_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OmniGibson Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              bddl_utils
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/StanfordVL/OmniGibson" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    StanfordVL/OmniGibson
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../index.html" class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../getting_started/installation.html" class="md-tabs__link">
        Getting Started
      </a>
    </li>
  

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="../SUMMARY.html" class="md-tabs__link md-tabs__link--active">
      API Reference
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="OmniGibson Documentation" class="md-nav__button md-logo" aria-label="OmniGibson Documentation" data-md-component="logo">
      
  <img src="../../assets/OmniGibson_logo.png" alt="logo">

    </a>
    OmniGibson Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/StanfordVL/OmniGibson" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    StanfordVL/OmniGibson
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/installation.html" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/quickstart.html" class="md-nav__link">
        Quickstart
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/building_blocks.html" class="md-nav__link">
        Building Blocks
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../SUMMARY.html">API Reference</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../macros.html" class="md-nav__link">
        macros
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../simulator.html" class="md-nav__link">
        simulator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../transition_rules.html" class="md-nav__link">
        transition_rules
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../controllers/index.html">Controllers</a>
          
            <label for="__nav_3_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Controllers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../controllers/controller_base.html" class="md-nav__link">
        controller_base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../controllers/dd_controller.html" class="md-nav__link">
        dd_controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../controllers/ik_controller.html" class="md-nav__link">
        ik_controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../controllers/joint_controller.html" class="md-nav__link">
        joint_controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../controllers/multi_finger_gripper_controller.html" class="md-nav__link">
        multi_finger_gripper_controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../controllers/null_joint_controller.html" class="md-nav__link">
        null_joint_controller
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../envs/index.html">Envs</a>
          
            <label for="__nav_3_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          Envs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../envs/env_base.html" class="md-nav__link">
        env_base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../envs/env_wrapper.html" class="md-nav__link">
        env_wrapper
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../examples/index.html">Examples</a>
          
            <label for="__nav_3_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_1" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../examples/environments/index.html">Environments</a>
          
            <label for="__nav_3_6_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6_1">
          <span class="md-nav__icon md-icon"></span>
          Environments
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/environments/behavior_env_demo.html" class="md-nav__link">
        behavior_env_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/environments/navigation_env_demo.html" class="md-nav__link">
        navigation_env_demo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_2" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../examples/learning/index.html">Learning</a>
          
            <label for="__nav_3_6_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6_2">
          <span class="md-nav__icon md-icon"></span>
          Learning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/learning/navigation_policy_demo.html" class="md-nav__link">
        navigation_policy_demo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_3" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../examples/object_states/index.html">Object states</a>
          
            <label for="__nav_3_6_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6_3">
          <span class="md-nav__icon md-icon"></span>
          Object states
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/object_states/attachment_demo.html" class="md-nav__link">
        attachment_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/object_states/dicing_demo.html" class="md-nav__link">
        dicing_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/object_states/folded_unfolded_state_demo.html" class="md-nav__link">
        folded_unfolded_state_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/object_states/heat_source_or_sink_demo.html" class="md-nav__link">
        heat_source_or_sink_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/object_states/heated_state_demo.html" class="md-nav__link">
        heated_state_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/object_states/object_state_texture_demo.html" class="md-nav__link">
        object_state_texture_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/object_states/onfire_demo.html" class="md-nav__link">
        onfire_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/object_states/overlaid_demo.html" class="md-nav__link">
        overlaid_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/object_states/particle_applier_remover_demo.html" class="md-nav__link">
        particle_applier_remover_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/object_states/particle_source_sink_demo.html" class="md-nav__link">
        particle_source_sink_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/object_states/sample_kinematics_demo.html" class="md-nav__link">
        sample_kinematics_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/object_states/slicing_demo.html" class="md-nav__link">
        slicing_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/object_states/temperature_demo.html" class="md-nav__link">
        temperature_demo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_4" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../examples/objects/index.html">Objects</a>
          
            <label for="__nav_3_6_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6_4">
          <span class="md-nav__icon md-icon"></span>
          Objects
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/objects/draw_bounding_box.html" class="md-nav__link">
        draw_bounding_box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/objects/highlight_objects.html" class="md-nav__link">
        highlight_objects
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/objects/load_object_selector.html" class="md-nav__link">
        load_object_selector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/objects/visualize_object.html" class="md-nav__link">
        visualize_object
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_5" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../examples/renderer_settings/index.html">Renderer settings</a>
          
            <label for="__nav_3_6_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6_5">
          <span class="md-nav__icon md-icon"></span>
          Renderer settings
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/renderer_settings/renderer_settings_example.html" class="md-nav__link">
        renderer_settings_example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_6" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../examples/robots/index.html">Robots</a>
          
            <label for="__nav_3_6_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6_6">
          <span class="md-nav__icon md-icon"></span>
          Robots
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/robots/all_robots_visualizer.html" class="md-nav__link">
        all_robots_visualizer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/robots/grasping_mode_example.html" class="md-nav__link">
        grasping_mode_example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/robots/robot_control_example.html" class="md-nav__link">
        robot_control_example
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_6_4" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../examples/robots/advanced/index.html">Advanced</a>
          
            <label for="__nav_3_6_6_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_6_6_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6_6_4">
          <span class="md-nav__icon md-icon"></span>
          Advanced
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/robots/advanced/ik_example.html" class="md-nav__link">
        ik_example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_7" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../examples/scenes/index.html">Scenes</a>
          
            <label for="__nav_3_6_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6_7">
          <span class="md-nav__icon md-icon"></span>
          Scenes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/scenes/scene_selector.html" class="md-nav__link">
        scene_selector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/scenes/scene_tour_demo.html" class="md-nav__link">
        scene_tour_demo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/scenes/traversability_map_example.html" class="md-nav__link">
        traversability_map_example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6_8" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../examples/simulator/index.html">Simulator</a>
          
            <label for="__nav_3_6_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_6_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_6_8">
          <span class="md-nav__icon md-icon"></span>
          Simulator
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/simulator/sim_save_load_example.html" class="md-nav__link">
        sim_save_load_example
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../maps/index.html">Maps</a>
          
            <label for="__nav_3_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_7">
          <span class="md-nav__icon md-icon"></span>
          Maps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../maps/map_base.html" class="md-nav__link">
        map_base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../maps/segmentation_map.html" class="md-nav__link">
        segmentation_map
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../maps/traversable_map.html" class="md-nav__link">
        traversable_map
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../object_states/index.html">Object states</a>
          
            <label for="__nav_3_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_8">
          <span class="md-nav__icon md-icon"></span>
          Object states
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/aabb.html" class="md-nav__link">
        aabb
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/adjacency.html" class="md-nav__link">
        adjacency
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/attached_to.html" class="md-nav__link">
        attached_to
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/burnt.html" class="md-nav__link">
        burnt
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/cloth_mixin.html" class="md-nav__link">
        cloth_mixin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/contact_bodies.html" class="md-nav__link">
        contact_bodies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/contact_particles.html" class="md-nav__link">
        contact_particles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/contact_subscribed_state_mixin.html" class="md-nav__link">
        contact_subscribed_state_mixin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/contains.html" class="md-nav__link">
        contains
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/cooked.html" class="md-nav__link">
        cooked
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/covered.html" class="md-nav__link">
        covered
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/draped.html" class="md-nav__link">
        draped
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/factory.html" class="md-nav__link">
        factory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/filled.html" class="md-nav__link">
        filled
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/folded.html" class="md-nav__link">
        folded
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/frozen.html" class="md-nav__link">
        frozen
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/heat_source_or_sink.html" class="md-nav__link">
        heat_source_or_sink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/heated.html" class="md-nav__link">
        heated
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/inside.html" class="md-nav__link">
        inside
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/joint_break_subscribed_state_mixin.html" class="md-nav__link">
        joint_break_subscribed_state_mixin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/kinematics_mixin.html" class="md-nav__link">
        kinematics_mixin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/link_based_state_mixin.html" class="md-nav__link">
        link_based_state_mixin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/max_temperature.html" class="md-nav__link">
        max_temperature
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/next_to.html" class="md-nav__link">
        next_to
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/object_state_base.html" class="md-nav__link">
        object_state_base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/on_fire.html" class="md-nav__link">
        on_fire
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/on_top.html" class="md-nav__link">
        on_top
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/open.html" class="md-nav__link">
        open
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/overlaid.html" class="md-nav__link">
        overlaid
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/particle_modifier.html" class="md-nav__link">
        particle_modifier
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/particle_source_or_sink.html" class="md-nav__link">
        particle_source_or_sink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/pose.html" class="md-nav__link">
        pose
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/saturated.html" class="md-nav__link">
        saturated
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/temperature.html" class="md-nav__link">
        temperature
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/toggle.html" class="md-nav__link">
        toggle
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/touching.html" class="md-nav__link">
        touching
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/under.html" class="md-nav__link">
        under
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object_states/update_state_mixin.html" class="md-nav__link">
        update_state_mixin
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../objects/index.html">Objects</a>
          
            <label for="__nav_3_9">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_9">
          <span class="md-nav__icon md-icon"></span>
          Objects
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../objects/controllable_object.html" class="md-nav__link">
        controllable_object
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../objects/dataset_object.html" class="md-nav__link">
        dataset_object
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../objects/light_object.html" class="md-nav__link">
        light_object
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../objects/object_base.html" class="md-nav__link">
        object_base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../objects/primitive_object.html" class="md-nav__link">
        primitive_object
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../objects/stateful_object.html" class="md-nav__link">
        stateful_object
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../objects/usd_object.html" class="md-nav__link">
        usd_object
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../prims/index.html">Prims</a>
          
            <label for="__nav_3_10">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_10">
          <span class="md-nav__icon md-icon"></span>
          Prims
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../prims/cloth_prim.html" class="md-nav__link">
        cloth_prim
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../prims/entity_prim.html" class="md-nav__link">
        entity_prim
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../prims/geom_prim.html" class="md-nav__link">
        geom_prim
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../prims/joint_prim.html" class="md-nav__link">
        joint_prim
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../prims/material_prim.html" class="md-nav__link">
        material_prim
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../prims/prim_base.html" class="md-nav__link">
        prim_base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../prims/rigid_prim.html" class="md-nav__link">
        rigid_prim
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../prims/xform_prim.html" class="md-nav__link">
        xform_prim
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_11" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../renderer_settings/index.html">Renderer settings</a>
          
            <label for="__nav_3_11">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_11">
          <span class="md-nav__icon md-icon"></span>
          Renderer settings
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../renderer_settings/common_settings.html" class="md-nav__link">
        common_settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../renderer_settings/path_tracing_settings.html" class="md-nav__link">
        path_tracing_settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../renderer_settings/post_processing_settings.html" class="md-nav__link">
        post_processing_settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../renderer_settings/real_time_settings.html" class="md-nav__link">
        real_time_settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../renderer_settings/renderer_settings.html" class="md-nav__link">
        renderer_settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../renderer_settings/settings_base.html" class="md-nav__link">
        settings_base
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_12" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../reward_functions/index.html">Reward functions</a>
          
            <label for="__nav_3_12">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_12_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_12">
          <span class="md-nav__icon md-icon"></span>
          Reward functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reward_functions/collision_reward.html" class="md-nav__link">
        collision_reward
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reward_functions/point_goal_reward.html" class="md-nav__link">
        point_goal_reward
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reward_functions/potential_reward.html" class="md-nav__link">
        potential_reward
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reward_functions/reaching_goal_reward.html" class="md-nav__link">
        reaching_goal_reward
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reward_functions/reward_function_base.html" class="md-nav__link">
        reward_function_base
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_13" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../robots/index.html">Robots</a>
          
            <label for="__nav_3_13">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_13_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_13">
          <span class="md-nav__icon md-icon"></span>
          Robots
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../robots/active_camera_robot.html" class="md-nav__link">
        active_camera_robot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../robots/fetch.html" class="md-nav__link">
        fetch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../robots/freight.html" class="md-nav__link">
        freight
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../robots/husky.html" class="md-nav__link">
        husky
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../robots/locobot.html" class="md-nav__link">
        locobot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../robots/locomotion_robot.html" class="md-nav__link">
        locomotion_robot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../robots/manipulation_robot.html" class="md-nav__link">
        manipulation_robot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../robots/robot_base.html" class="md-nav__link">
        robot_base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../robots/tiago.html" class="md-nav__link">
        tiago
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../robots/turtlebot.html" class="md-nav__link">
        turtlebot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../robots/two_wheel_robot.html" class="md-nav__link">
        two_wheel_robot
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_14" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../scenes/index.html">Scenes</a>
          
            <label for="__nav_3_14">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_14_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_14">
          <span class="md-nav__icon md-icon"></span>
          Scenes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scenes/interactive_traversable_scene.html" class="md-nav__link">
        interactive_traversable_scene
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scenes/scene_base.html" class="md-nav__link">
        scene_base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scenes/static_traversable_scene.html" class="md-nav__link">
        static_traversable_scene
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scenes/traversable_scene.html" class="md-nav__link">
        traversable_scene
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_15" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../sensors/index.html">Sensors</a>
          
            <label for="__nav_3_15">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_15_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_15">
          <span class="md-nav__icon md-icon"></span>
          Sensors
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sensors/dropout_sensor_noise.html" class="md-nav__link">
        dropout_sensor_noise
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sensors/scan_sensor.html" class="md-nav__link">
        scan_sensor
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sensors/sensor_base.html" class="md-nav__link">
        sensor_base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sensors/sensor_noise_base.html" class="md-nav__link">
        sensor_noise_base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sensors/vision_sensor.html" class="md-nav__link">
        vision_sensor
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_16" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../systems/index.html">Systems</a>
          
            <label for="__nav_3_16">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_16_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_16">
          <span class="md-nav__icon md-icon"></span>
          Systems
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../systems/macro_particle_system.html" class="md-nav__link">
        macro_particle_system
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../systems/micro_particle_system.html" class="md-nav__link">
        micro_particle_system
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../systems/system_base.html" class="md-nav__link">
        system_base
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_17" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../tasks/index.html">Tasks</a>
          
            <label for="__nav_3_17">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_17_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_17">
          <span class="md-nav__icon md-icon"></span>
          Tasks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tasks/behavior_task.html" class="md-nav__link">
        behavior_task
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tasks/dummy_task.html" class="md-nav__link">
        dummy_task
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tasks/point_navigation_task.html" class="md-nav__link">
        point_navigation_task
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tasks/point_reaching_task.html" class="md-nav__link">
        point_reaching_task
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tasks/task_base.html" class="md-nav__link">
        task_base
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_18" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../termination_conditions/index.html">Termination conditions</a>
          
            <label for="__nav_3_18">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_18_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_18">
          <span class="md-nav__icon md-icon"></span>
          Termination conditions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../termination_conditions/falling.html" class="md-nav__link">
        falling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../termination_conditions/max_collision.html" class="md-nav__link">
        max_collision
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../termination_conditions/point_goal.html" class="md-nav__link">
        point_goal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../termination_conditions/predicate_goal.html" class="md-nav__link">
        predicate_goal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../termination_conditions/reaching_goal.html" class="md-nav__link">
        reaching_goal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../termination_conditions/termination_condition_base.html" class="md-nav__link">
        termination_condition_base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../termination_conditions/timeout.html" class="md-nav__link">
        timeout
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_19" checked>
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="index.html">Utils</a>
          
            <label for="__nav_3_19">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_19_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_19">
          <span class="md-nav__icon md-icon"></span>
          Utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="asset_utils.html" class="md-nav__link">
        asset_utils
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          bddl_utils
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="bddl_utils.html" class="md-nav__link md-nav__link--active">
        bddl_utils
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#utils.bddl_utils" class="md-nav__link">
    utils.bddl_utils
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity" class="md-nav__link">
    BDDLEntity
  </a>
  
    <nav class="md-nav" aria-label="BDDLEntity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.exists" class="md-nav__link">
    exists
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.clear_entity" class="md-nav__link">
    clear_entity()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.get_state" class="md-nav__link">
    get_state()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.set_entity" class="md-nav__link">
    set_entity()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.set_state" class="md-nav__link">
    set_state()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLSampler" class="md-nav__link">
    BDDLSampler
  </a>
  
    <nav class="md-nav" aria-label="BDDLSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLSampler.sample" class="md-nav__link">
    sample()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.bddl_utils.process_single_condition" class="md-nav__link">
    process_single_condition()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="config_utils.html" class="md-nav__link">
        config_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="constants.html" class="md-nav__link">
        constants
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="control_utils.html" class="md-nav__link">
        control_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="deprecated_utils.html" class="md-nav__link">
        deprecated_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="geometry_utils.html" class="md-nav__link">
        geometry_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="git_utils.html" class="md-nav__link">
        git_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="gym_utils.html" class="md-nav__link">
        gym_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="object_state_utils.html" class="md-nav__link">
        object_state_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="object_utils.html" class="md-nav__link">
        object_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="physx_utils.html" class="md-nav__link">
        physx_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="processing_utils.html" class="md-nav__link">
        processing_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="python_utils.html" class="md-nav__link">
        python_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="registry_utils.html" class="md-nav__link">
        registry_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="render_utils.html" class="md-nav__link">
        render_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="sampling_utils.html" class="md-nav__link">
        sampling_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="sim_utils.html" class="md-nav__link">
        sim_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="transform_utils.html" class="md-nav__link">
        transform_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ui_utils.html" class="md-nav__link">
        ui_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="usd_utils.html" class="md-nav__link">
        usd_utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="vision_utils.html" class="md-nav__link">
        vision_utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#utils.bddl_utils" class="md-nav__link">
    utils.bddl_utils
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity" class="md-nav__link">
    BDDLEntity
  </a>
  
    <nav class="md-nav" aria-label="BDDLEntity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.exists" class="md-nav__link">
    exists
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.name" class="md-nav__link">
    name
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.clear_entity" class="md-nav__link">
    clear_entity()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.get_state" class="md-nav__link">
    get_state()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.set_entity" class="md-nav__link">
    set_entity()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLEntity.set_state" class="md-nav__link">
    set_state()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLSampler" class="md-nav__link">
    BDDLSampler
  </a>
  
    <nav class="md-nav" aria-label="BDDLSampler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utils.bddl_utils.BDDLSampler.sample" class="md-nav__link">
    sample()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utils.bddl_utils.process_single_condition" class="md-nav__link">
    process_single_condition()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="bddl_utils">bddl_utils</h1>


<div class="doc doc-object doc-module">


<a id="utils.bddl_utils"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="utils.bddl_utils.BDDLEntity">
        <code>BDDLEntity</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="omnigibson.utils.python_utils.Wrapper">Wrapper</span></code></p>

  
      <p>Thin wrapper class that wraps an object or system if it exists, or nothing if it does not exist. Will
dynamically reference an object / system as they become real in the sim</p>


        <details class="quote">
          <summary>Source code in <code>omnigibson/utils/bddl_utils.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="k">class</span> <span class="nc">BDDLEntity</span><span class="p">(</span><span class="n">Wrapper</span><span class="p">):</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    Thin wrapper class that wraps an object or system if it exists, or nothing if it does not exist. Will</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">    dynamically reference an object / system as they become real in the sim</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">bddl_inst</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="n">entity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>    <span class="p">):</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">            bddl_inst (str): BDDL synset instance of the entity, e.g.: &quot;almond.n.01_1&quot;</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">            entity (None or DatasetObject or BaseSystem): If specified, the BDDL entity to wrap. If not</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">                specified, will initially wrap nothing, but may dynamically reference an actual object or system</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">                if it exists in the future</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>        <span class="c1"># Store synset and other info, and pass entity internally</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bddl_inst</span> <span class="o">=</span> <span class="n">bddl_inst</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">synset</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bddl_inst</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_system</span> <span class="o">=</span> <span class="n">is_substance_synset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">synset</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="c1"># Infer the correct category to assign</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">og_categories</span> <span class="o">=</span> <span class="n">OBJECT_TAXONOMY</span><span class="o">.</span><span class="n">get_subtree_categories</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">synset</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">entity</span><span class="p">)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">            None or str: Name of this entity, if it exists, else None</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists</span><span class="p">:</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">og_categories</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_system</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_obj</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="k">def</span> <span class="nf">exists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a><span class="sd">        Checks whether the entity referenced by @synset exists</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a><span class="sd">            bool: Whether the entity referenced by @synset exists</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="k">def</span> <span class="nf">set_entity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity</span><span class="p">):</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">        Sets the internal entity, overriding any if it already exists</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">            entity (BaseSystem or BaseObject): Entity to set internally</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_obj</span> <span class="o">=</span> <span class="n">entity</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>    <span class="k">def</span> <span class="nf">clear_entity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        Clears the internal entity, if any</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_obj</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>    <span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">        Helper function to grab wrapped entity&#39;s state @state</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">            state (BaseObjectState): State whose get_value() should be called</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">            *args (tuple): Any arguments to pass to getter, in order</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">            **kwargs (dict): Any keyword arguments to pass to getter, in order</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">            None or any: Returned value(s) from @state if self.wrapped_obj exists (i.e.: not None), else None</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_obj</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">state</span><span class="p">]</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="k">def</span> <span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">        Helper function to set wrapped entity&#39;s state @state. Note: Should only be called if the entity exists!</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">            state (BaseObjectState): State whose set_value() should be called</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">            *args (tuple): Any arguments to pass to getter, in order</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">            **kwargs (dict): Any keyword arguments to pass to getter, in order</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">            any: Returned value(s) from @state if self.wrapped_obj exists (i.e.: not None)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists</span><span class="p">,</span> \
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="sa">f</span><span class="s2">&quot;Cannot call set_state() for BDDLEntity </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">synset</span><span class="si">}</span><span class="s2"> when the entity does not exist!&quot;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_obj</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">state</span><span class="p">]</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="utils.bddl_utils.BDDLEntity.exists">
<code class="highlight language-python"><span class="n">exists</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Checks whether the entity referenced by @synset exists</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>bool</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether the entity referenced by @synset exists</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 class="doc doc-heading" id="utils.bddl_utils.BDDLEntity.name">
<code class="highlight language-python"><span class="n">name</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None or str: Name of this entity, if it exists, else None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 class="doc doc-heading" id="utils.bddl_utils.BDDLEntity.__init__">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">bddl_inst</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>bddl_inst</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>BDDL synset instance of the entity, e.g.: "almond.n.01_1"</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>entity</code></td>
          <td>
                <code>None or DatasetObject or BaseSystem</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If specified, the BDDL entity to wrap. If not
specified, will initially wrap nothing, but may dynamically reference an actual object or system
if it exists in the future</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>omnigibson/utils/bddl_utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-179" name="__codelineno-0-179"></a><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="n">bddl_inst</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">entity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="p">):</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">        bddl_inst (str): BDDL synset instance of the entity, e.g.: &quot;almond.n.01_1&quot;</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        entity (None or DatasetObject or BaseSystem): If specified, the BDDL entity to wrap. If not</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">            specified, will initially wrap nothing, but may dynamically reference an actual object or system</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">            if it exists in the future</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>    <span class="c1"># Store synset and other info, and pass entity internally</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">bddl_inst</span> <span class="o">=</span> <span class="n">bddl_inst</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">synset</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bddl_inst</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">is_system</span> <span class="o">=</span> <span class="n">is_substance_synset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">synset</span><span class="p">)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="c1"># Infer the correct category to assign</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">og_categories</span> <span class="o">=</span> <span class="n">OBJECT_TAXONOMY</span><span class="o">.</span><span class="n">get_subtree_categories</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">synset</span><span class="p">)</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">entity</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 class="doc doc-heading" id="utils.bddl_utils.BDDLEntity.clear_entity">
<code class="highlight language-python"><span class="n">clear_entity</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Clears the internal entity, if any</p>

      <details class="quote">
        <summary>Source code in <code>omnigibson/utils/bddl_utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="k">def</span> <span class="nf">clear_entity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">    Clears the internal entity, if any</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_obj</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 class="doc doc-heading" id="utils.bddl_utils.BDDLEntity.get_state">
<code class="highlight language-python"><span class="n">get_state</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Helper function to grab wrapped entity's state @state</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>state</code></td>
          <td>
                <code>BaseObjectState</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>State whose get_value() should be called</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>*args</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Any arguments to pass to getter, in order</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Any keyword arguments to pass to getter, in order</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>None or any: Returned value(s) from @state if self.wrapped_obj exists (i.e.: not None), else None</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>omnigibson/utils/bddl_utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="k">def</span> <span class="nf">get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a><span class="sd">    Helper function to grab wrapped entity&#39;s state @state</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">        state (BaseObjectState): State whose get_value() should be called</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a><span class="sd">        *args (tuple): Any arguments to pass to getter, in order</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a><span class="sd">        **kwargs (dict): Any keyword arguments to pass to getter, in order</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a><span class="sd">        None or any: Returned value(s) from @state if self.wrapped_obj exists (i.e.: not None), else None</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_obj</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">state</span><span class="p">]</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists</span> <span class="k">else</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 class="doc doc-heading" id="utils.bddl_utils.BDDLEntity.set_entity">
<code class="highlight language-python"><span class="n">set_entity</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sets the internal entity, overriding any if it already exists</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>entity</code></td>
          <td>
                <code>BaseSystem or BaseObject</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Entity to set internally</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>omnigibson/utils/bddl_utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-222" name="__codelineno-0-222"></a><span class="k">def</span> <span class="nf">set_entity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity</span><span class="p">):</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a><span class="sd">    Sets the internal entity, overriding any if it already exists</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a><span class="sd">        entity (BaseSystem or BaseObject): Entity to set internally</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_obj</span> <span class="o">=</span> <span class="n">entity</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 class="doc doc-heading" id="utils.bddl_utils.BDDLEntity.set_state">
<code class="highlight language-python"><span class="n">set_state</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Helper function to set wrapped entity's state @state. Note: Should only be called if the entity exists!</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>state</code></td>
          <td>
                <code>BaseObjectState</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>State whose set_value() should be called</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>*args</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Any arguments to pass to getter, in order</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Any keyword arguments to pass to getter, in order</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>any</code></td>          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Returned value(s) from @state if self.wrapped_obj exists (i.e.: not None)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>omnigibson/utils/bddl_utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-251" name="__codelineno-0-251"></a><span class="k">def</span> <span class="nf">set_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a><span class="sd">    Helper function to set wrapped entity&#39;s state @state. Note: Should only be called if the entity exists!</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a><span class="sd">        state (BaseObjectState): State whose set_value() should be called</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a><span class="sd">        *args (tuple): Any arguments to pass to getter, in order</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a><span class="sd">        **kwargs (dict): Any keyword arguments to pass to getter, in order</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a><span class="sd">        any: Returned value(s) from @state if self.wrapped_obj exists (i.e.: not None)</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">exists</span><span class="p">,</span> \
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="sa">f</span><span class="s2">&quot;Cannot call set_state() for BDDLEntity </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">synset</span><span class="si">}</span><span class="s2"> when the entity does not exist!&quot;</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wrapped_obj</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">state</span><span class="p">]</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 class="doc doc-heading" id="utils.bddl_utils.BDDLSampler">
        <code>BDDLSampler</code>


</h2>


  <div class="doc doc-contents ">



        <details class="quote">
          <summary>Source code in <code>omnigibson/utils/bddl_utils.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span>
<span class="normal"><a href="#__codelineno-0-290">290</a></span>
<span class="normal"><a href="#__codelineno-0-291">291</a></span>
<span class="normal"><a href="#__codelineno-0-292">292</a></span>
<span class="normal"><a href="#__codelineno-0-293">293</a></span>
<span class="normal"><a href="#__codelineno-0-294">294</a></span>
<span class="normal"><a href="#__codelineno-0-295">295</a></span>
<span class="normal"><a href="#__codelineno-0-296">296</a></span>
<span class="normal"><a href="#__codelineno-0-297">297</a></span>
<span class="normal"><a href="#__codelineno-0-298">298</a></span>
<span class="normal"><a href="#__codelineno-0-299">299</a></span>
<span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span>
<span class="normal"><a href="#__codelineno-0-468">468</a></span>
<span class="normal"><a href="#__codelineno-0-469">469</a></span>
<span class="normal"><a href="#__codelineno-0-470">470</a></span>
<span class="normal"><a href="#__codelineno-0-471">471</a></span>
<span class="normal"><a href="#__codelineno-0-472">472</a></span>
<span class="normal"><a href="#__codelineno-0-473">473</a></span>
<span class="normal"><a href="#__codelineno-0-474">474</a></span>
<span class="normal"><a href="#__codelineno-0-475">475</a></span>
<span class="normal"><a href="#__codelineno-0-476">476</a></span>
<span class="normal"><a href="#__codelineno-0-477">477</a></span>
<span class="normal"><a href="#__codelineno-0-478">478</a></span>
<span class="normal"><a href="#__codelineno-0-479">479</a></span>
<span class="normal"><a href="#__codelineno-0-480">480</a></span>
<span class="normal"><a href="#__codelineno-0-481">481</a></span>
<span class="normal"><a href="#__codelineno-0-482">482</a></span>
<span class="normal"><a href="#__codelineno-0-483">483</a></span>
<span class="normal"><a href="#__codelineno-0-484">484</a></span>
<span class="normal"><a href="#__codelineno-0-485">485</a></span>
<span class="normal"><a href="#__codelineno-0-486">486</a></span>
<span class="normal"><a href="#__codelineno-0-487">487</a></span>
<span class="normal"><a href="#__codelineno-0-488">488</a></span>
<span class="normal"><a href="#__codelineno-0-489">489</a></span>
<span class="normal"><a href="#__codelineno-0-490">490</a></span>
<span class="normal"><a href="#__codelineno-0-491">491</a></span>
<span class="normal"><a href="#__codelineno-0-492">492</a></span>
<span class="normal"><a href="#__codelineno-0-493">493</a></span>
<span class="normal"><a href="#__codelineno-0-494">494</a></span>
<span class="normal"><a href="#__codelineno-0-495">495</a></span>
<span class="normal"><a href="#__codelineno-0-496">496</a></span>
<span class="normal"><a href="#__codelineno-0-497">497</a></span>
<span class="normal"><a href="#__codelineno-0-498">498</a></span>
<span class="normal"><a href="#__codelineno-0-499">499</a></span>
<span class="normal"><a href="#__codelineno-0-500">500</a></span>
<span class="normal"><a href="#__codelineno-0-501">501</a></span>
<span class="normal"><a href="#__codelineno-0-502">502</a></span>
<span class="normal"><a href="#__codelineno-0-503">503</a></span>
<span class="normal"><a href="#__codelineno-0-504">504</a></span>
<span class="normal"><a href="#__codelineno-0-505">505</a></span>
<span class="normal"><a href="#__codelineno-0-506">506</a></span>
<span class="normal"><a href="#__codelineno-0-507">507</a></span>
<span class="normal"><a href="#__codelineno-0-508">508</a></span>
<span class="normal"><a href="#__codelineno-0-509">509</a></span>
<span class="normal"><a href="#__codelineno-0-510">510</a></span>
<span class="normal"><a href="#__codelineno-0-511">511</a></span>
<span class="normal"><a href="#__codelineno-0-512">512</a></span>
<span class="normal"><a href="#__codelineno-0-513">513</a></span>
<span class="normal"><a href="#__codelineno-0-514">514</a></span>
<span class="normal"><a href="#__codelineno-0-515">515</a></span>
<span class="normal"><a href="#__codelineno-0-516">516</a></span>
<span class="normal"><a href="#__codelineno-0-517">517</a></span>
<span class="normal"><a href="#__codelineno-0-518">518</a></span>
<span class="normal"><a href="#__codelineno-0-519">519</a></span>
<span class="normal"><a href="#__codelineno-0-520">520</a></span>
<span class="normal"><a href="#__codelineno-0-521">521</a></span>
<span class="normal"><a href="#__codelineno-0-522">522</a></span>
<span class="normal"><a href="#__codelineno-0-523">523</a></span>
<span class="normal"><a href="#__codelineno-0-524">524</a></span>
<span class="normal"><a href="#__codelineno-0-525">525</a></span>
<span class="normal"><a href="#__codelineno-0-526">526</a></span>
<span class="normal"><a href="#__codelineno-0-527">527</a></span>
<span class="normal"><a href="#__codelineno-0-528">528</a></span>
<span class="normal"><a href="#__codelineno-0-529">529</a></span>
<span class="normal"><a href="#__codelineno-0-530">530</a></span>
<span class="normal"><a href="#__codelineno-0-531">531</a></span>
<span class="normal"><a href="#__codelineno-0-532">532</a></span>
<span class="normal"><a href="#__codelineno-0-533">533</a></span>
<span class="normal"><a href="#__codelineno-0-534">534</a></span>
<span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span>
<span class="normal"><a href="#__codelineno-0-617">617</a></span>
<span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span>
<span class="normal"><a href="#__codelineno-0-627">627</a></span>
<span class="normal"><a href="#__codelineno-0-628">628</a></span>
<span class="normal"><a href="#__codelineno-0-629">629</a></span>
<span class="normal"><a href="#__codelineno-0-630">630</a></span>
<span class="normal"><a href="#__codelineno-0-631">631</a></span>
<span class="normal"><a href="#__codelineno-0-632">632</a></span>
<span class="normal"><a href="#__codelineno-0-633">633</a></span>
<span class="normal"><a href="#__codelineno-0-634">634</a></span>
<span class="normal"><a href="#__codelineno-0-635">635</a></span>
<span class="normal"><a href="#__codelineno-0-636">636</a></span>
<span class="normal"><a href="#__codelineno-0-637">637</a></span>
<span class="normal"><a href="#__codelineno-0-638">638</a></span>
<span class="normal"><a href="#__codelineno-0-639">639</a></span>
<span class="normal"><a href="#__codelineno-0-640">640</a></span>
<span class="normal"><a href="#__codelineno-0-641">641</a></span>
<span class="normal"><a href="#__codelineno-0-642">642</a></span>
<span class="normal"><a href="#__codelineno-0-643">643</a></span>
<span class="normal"><a href="#__codelineno-0-644">644</a></span>
<span class="normal"><a href="#__codelineno-0-645">645</a></span>
<span class="normal"><a href="#__codelineno-0-646">646</a></span>
<span class="normal"><a href="#__codelineno-0-647">647</a></span>
<span class="normal"><a href="#__codelineno-0-648">648</a></span>
<span class="normal"><a href="#__codelineno-0-649">649</a></span>
<span class="normal"><a href="#__codelineno-0-650">650</a></span>
<span class="normal"><a href="#__codelineno-0-651">651</a></span>
<span class="normal"><a href="#__codelineno-0-652">652</a></span>
<span class="normal"><a href="#__codelineno-0-653">653</a></span>
<span class="normal"><a href="#__codelineno-0-654">654</a></span>
<span class="normal"><a href="#__codelineno-0-655">655</a></span>
<span class="normal"><a href="#__codelineno-0-656">656</a></span>
<span class="normal"><a href="#__codelineno-0-657">657</a></span>
<span class="normal"><a href="#__codelineno-0-658">658</a></span>
<span class="normal"><a href="#__codelineno-0-659">659</a></span>
<span class="normal"><a href="#__codelineno-0-660">660</a></span>
<span class="normal"><a href="#__codelineno-0-661">661</a></span>
<span class="normal"><a href="#__codelineno-0-662">662</a></span>
<span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span>
<span class="normal"><a href="#__codelineno-0-677">677</a></span>
<span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span>
<span class="normal"><a href="#__codelineno-0-700">700</a></span>
<span class="normal"><a href="#__codelineno-0-701">701</a></span>
<span class="normal"><a href="#__codelineno-0-702">702</a></span>
<span class="normal"><a href="#__codelineno-0-703">703</a></span>
<span class="normal"><a href="#__codelineno-0-704">704</a></span>
<span class="normal"><a href="#__codelineno-0-705">705</a></span>
<span class="normal"><a href="#__codelineno-0-706">706</a></span>
<span class="normal"><a href="#__codelineno-0-707">707</a></span>
<span class="normal"><a href="#__codelineno-0-708">708</a></span>
<span class="normal"><a href="#__codelineno-0-709">709</a></span>
<span class="normal"><a href="#__codelineno-0-710">710</a></span>
<span class="normal"><a href="#__codelineno-0-711">711</a></span>
<span class="normal"><a href="#__codelineno-0-712">712</a></span>
<span class="normal"><a href="#__codelineno-0-713">713</a></span>
<span class="normal"><a href="#__codelineno-0-714">714</a></span>
<span class="normal"><a href="#__codelineno-0-715">715</a></span>
<span class="normal"><a href="#__codelineno-0-716">716</a></span>
<span class="normal"><a href="#__codelineno-0-717">717</a></span>
<span class="normal"><a href="#__codelineno-0-718">718</a></span>
<span class="normal"><a href="#__codelineno-0-719">719</a></span>
<span class="normal"><a href="#__codelineno-0-720">720</a></span>
<span class="normal"><a href="#__codelineno-0-721">721</a></span>
<span class="normal"><a href="#__codelineno-0-722">722</a></span>
<span class="normal"><a href="#__codelineno-0-723">723</a></span>
<span class="normal"><a href="#__codelineno-0-724">724</a></span>
<span class="normal"><a href="#__codelineno-0-725">725</a></span>
<span class="normal"><a href="#__codelineno-0-726">726</a></span>
<span class="normal"><a href="#__codelineno-0-727">727</a></span>
<span class="normal"><a href="#__codelineno-0-728">728</a></span>
<span class="normal"><a href="#__codelineno-0-729">729</a></span>
<span class="normal"><a href="#__codelineno-0-730">730</a></span>
<span class="normal"><a href="#__codelineno-0-731">731</a></span>
<span class="normal"><a href="#__codelineno-0-732">732</a></span>
<span class="normal"><a href="#__codelineno-0-733">733</a></span>
<span class="normal"><a href="#__codelineno-0-734">734</a></span>
<span class="normal"><a href="#__codelineno-0-735">735</a></span>
<span class="normal"><a href="#__codelineno-0-736">736</a></span>
<span class="normal"><a href="#__codelineno-0-737">737</a></span>
<span class="normal"><a href="#__codelineno-0-738">738</a></span>
<span class="normal"><a href="#__codelineno-0-739">739</a></span>
<span class="normal"><a href="#__codelineno-0-740">740</a></span>
<span class="normal"><a href="#__codelineno-0-741">741</a></span>
<span class="normal"><a href="#__codelineno-0-742">742</a></span>
<span class="normal"><a href="#__codelineno-0-743">743</a></span>
<span class="normal"><a href="#__codelineno-0-744">744</a></span>
<span class="normal"><a href="#__codelineno-0-745">745</a></span>
<span class="normal"><a href="#__codelineno-0-746">746</a></span>
<span class="normal"><a href="#__codelineno-0-747">747</a></span>
<span class="normal"><a href="#__codelineno-0-748">748</a></span>
<span class="normal"><a href="#__codelineno-0-749">749</a></span>
<span class="normal"><a href="#__codelineno-0-750">750</a></span>
<span class="normal"><a href="#__codelineno-0-751">751</a></span>
<span class="normal"><a href="#__codelineno-0-752">752</a></span>
<span class="normal"><a href="#__codelineno-0-753">753</a></span>
<span class="normal"><a href="#__codelineno-0-754">754</a></span>
<span class="normal"><a href="#__codelineno-0-755">755</a></span>
<span class="normal"><a href="#__codelineno-0-756">756</a></span>
<span class="normal"><a href="#__codelineno-0-757">757</a></span>
<span class="normal"><a href="#__codelineno-0-758">758</a></span>
<span class="normal"><a href="#__codelineno-0-759">759</a></span>
<span class="normal"><a href="#__codelineno-0-760">760</a></span>
<span class="normal"><a href="#__codelineno-0-761">761</a></span>
<span class="normal"><a href="#__codelineno-0-762">762</a></span>
<span class="normal"><a href="#__codelineno-0-763">763</a></span>
<span class="normal"><a href="#__codelineno-0-764">764</a></span>
<span class="normal"><a href="#__codelineno-0-765">765</a></span>
<span class="normal"><a href="#__codelineno-0-766">766</a></span>
<span class="normal"><a href="#__codelineno-0-767">767</a></span>
<span class="normal"><a href="#__codelineno-0-768">768</a></span>
<span class="normal"><a href="#__codelineno-0-769">769</a></span>
<span class="normal"><a href="#__codelineno-0-770">770</a></span>
<span class="normal"><a href="#__codelineno-0-771">771</a></span>
<span class="normal"><a href="#__codelineno-0-772">772</a></span>
<span class="normal"><a href="#__codelineno-0-773">773</a></span>
<span class="normal"><a href="#__codelineno-0-774">774</a></span>
<span class="normal"><a href="#__codelineno-0-775">775</a></span>
<span class="normal"><a href="#__codelineno-0-776">776</a></span>
<span class="normal"><a href="#__codelineno-0-777">777</a></span>
<span class="normal"><a href="#__codelineno-0-778">778</a></span>
<span class="normal"><a href="#__codelineno-0-779">779</a></span>
<span class="normal"><a href="#__codelineno-0-780">780</a></span>
<span class="normal"><a href="#__codelineno-0-781">781</a></span>
<span class="normal"><a href="#__codelineno-0-782">782</a></span>
<span class="normal"><a href="#__codelineno-0-783">783</a></span>
<span class="normal"><a href="#__codelineno-0-784">784</a></span>
<span class="normal"><a href="#__codelineno-0-785">785</a></span>
<span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span>
<span class="normal"><a href="#__codelineno-0-827">827</a></span>
<span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span>
<span class="normal"><a href="#__codelineno-0-852">852</a></span>
<span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span>
<span class="normal"><a href="#__codelineno-0-877">877</a></span>
<span class="normal"><a href="#__codelineno-0-878">878</a></span>
<span class="normal"><a href="#__codelineno-0-879">879</a></span>
<span class="normal"><a href="#__codelineno-0-880">880</a></span>
<span class="normal"><a href="#__codelineno-0-881">881</a></span>
<span class="normal"><a href="#__codelineno-0-882">882</a></span>
<span class="normal"><a href="#__codelineno-0-883">883</a></span>
<span class="normal"><a href="#__codelineno-0-884">884</a></span>
<span class="normal"><a href="#__codelineno-0-885">885</a></span>
<span class="normal"><a href="#__codelineno-0-886">886</a></span>
<span class="normal"><a href="#__codelineno-0-887">887</a></span>
<span class="normal"><a href="#__codelineno-0-888">888</a></span>
<span class="normal"><a href="#__codelineno-0-889">889</a></span>
<span class="normal"><a href="#__codelineno-0-890">890</a></span>
<span class="normal"><a href="#__codelineno-0-891">891</a></span>
<span class="normal"><a href="#__codelineno-0-892">892</a></span>
<span class="normal"><a href="#__codelineno-0-893">893</a></span>
<span class="normal"><a href="#__codelineno-0-894">894</a></span>
<span class="normal"><a href="#__codelineno-0-895">895</a></span>
<span class="normal"><a href="#__codelineno-0-896">896</a></span>
<span class="normal"><a href="#__codelineno-0-897">897</a></span>
<span class="normal"><a href="#__codelineno-0-898">898</a></span>
<span class="normal"><a href="#__codelineno-0-899">899</a></span>
<span class="normal"><a href="#__codelineno-0-900">900</a></span>
<span class="normal"><a href="#__codelineno-0-901">901</a></span>
<span class="normal"><a href="#__codelineno-0-902">902</a></span>
<span class="normal"><a href="#__codelineno-0-903">903</a></span>
<span class="normal"><a href="#__codelineno-0-904">904</a></span>
<span class="normal"><a href="#__codelineno-0-905">905</a></span>
<span class="normal"><a href="#__codelineno-0-906">906</a></span>
<span class="normal"><a href="#__codelineno-0-907">907</a></span>
<span class="normal"><a href="#__codelineno-0-908">908</a></span>
<span class="normal"><a href="#__codelineno-0-909">909</a></span>
<span class="normal"><a href="#__codelineno-0-910">910</a></span>
<span class="normal"><a href="#__codelineno-0-911">911</a></span>
<span class="normal"><a href="#__codelineno-0-912">912</a></span>
<span class="normal"><a href="#__codelineno-0-913">913</a></span>
<span class="normal"><a href="#__codelineno-0-914">914</a></span>
<span class="normal"><a href="#__codelineno-0-915">915</a></span>
<span class="normal"><a href="#__codelineno-0-916">916</a></span>
<span class="normal"><a href="#__codelineno-0-917">917</a></span>
<span class="normal"><a href="#__codelineno-0-918">918</a></span>
<span class="normal"><a href="#__codelineno-0-919">919</a></span>
<span class="normal"><a href="#__codelineno-0-920">920</a></span>
<span class="normal"><a href="#__codelineno-0-921">921</a></span>
<span class="normal"><a href="#__codelineno-0-922">922</a></span>
<span class="normal"><a href="#__codelineno-0-923">923</a></span>
<span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span>
<span class="normal"><a href="#__codelineno-0-964">964</a></span>
<span class="normal"><a href="#__codelineno-0-965">965</a></span>
<span class="normal"><a href="#__codelineno-0-966">966</a></span>
<span class="normal"><a href="#__codelineno-0-967">967</a></span>
<span class="normal"><a href="#__codelineno-0-968">968</a></span>
<span class="normal"><a href="#__codelineno-0-969">969</a></span>
<span class="normal"><a href="#__codelineno-0-970">970</a></span>
<span class="normal"><a href="#__codelineno-0-971">971</a></span>
<span class="normal"><a href="#__codelineno-0-972">972</a></span>
<span class="normal"><a href="#__codelineno-0-973">973</a></span>
<span class="normal"><a href="#__codelineno-0-974">974</a></span>
<span class="normal"><a href="#__codelineno-0-975">975</a></span>
<span class="normal"><a href="#__codelineno-0-976">976</a></span>
<span class="normal"><a href="#__codelineno-0-977">977</a></span>
<span class="normal"><a href="#__codelineno-0-978">978</a></span>
<span class="normal"><a href="#__codelineno-0-979">979</a></span>
<span class="normal"><a href="#__codelineno-0-980">980</a></span>
<span class="normal"><a href="#__codelineno-0-981">981</a></span>
<span class="normal"><a href="#__codelineno-0-982">982</a></span>
<span class="normal"><a href="#__codelineno-0-983">983</a></span>
<span class="normal"><a href="#__codelineno-0-984">984</a></span>
<span class="normal"><a href="#__codelineno-0-985">985</a></span>
<span class="normal"><a href="#__codelineno-0-986">986</a></span>
<span class="normal"><a href="#__codelineno-0-987">987</a></span>
<span class="normal"><a href="#__codelineno-0-988">988</a></span>
<span class="normal"><a href="#__codelineno-0-989">989</a></span>
<span class="normal"><a href="#__codelineno-0-990">990</a></span>
<span class="normal"><a href="#__codelineno-0-991">991</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-268" name="__codelineno-0-268"></a><span class="k">class</span> <span class="nc">BDDLSampler</span><span class="p">:</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="n">env</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">activity_conditions</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="n">object_scope</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="n">backend</span><span class="p">,</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="p">):</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="c1"># Store internal variables from inputs</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_env</span> <span class="o">=</span> <span class="n">env</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_scene_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">scene_model</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_agent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="o">.</span><span class="n">robots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>            <span class="n">gm</span><span class="o">.</span><span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span> <span class="o">=</span> <span class="n">backend</span>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_activity_conditions</span> <span class="o">=</span> <span class="n">activity_conditions</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span> <span class="o">=</span> <span class="n">object_scope</span>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_object_instance_to_synset</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>            <span class="n">obj_inst</span><span class="p">:</span> <span class="n">obj_cat</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>            <span class="k">for</span> <span class="n">obj_cat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_activity_conditions</span><span class="o">.</span><span class="n">parsed_objects</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="k">for</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_activity_conditions</span><span class="o">.</span><span class="n">parsed_objects</span><span class="p">[</span><span class="n">obj_cat</span><span class="p">]</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>        <span class="p">}</span>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_substance_instances</span> <span class="o">=</span> <span class="p">{</span><span class="n">obj_inst</span> <span class="k">for</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>                                     <span class="n">is_substance_synset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_object_instance_to_synset</span><span class="p">[</span><span class="n">obj_inst</span><span class="p">])}</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="c1"># Initialize other variables that will be filled in later</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_room_type_to_object_instance</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1"># dict</span>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_instances</span> <span class="o">=</span> <span class="kc">None</span>        <span class="c1"># set of str</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_object_sampling_orders</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1"># dict mapping str to list of str</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sampled_objects</span> <span class="o">=</span> <span class="kc">None</span>                        <span class="c1"># set of BaseObject</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_future_obj_instances</span> <span class="o">=</span> <span class="kc">None</span>                   <span class="c1"># set of str</span>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_conditions</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1"># list of (condition, positive) tuple</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_scope_filtered_initial</span> <span class="o">=</span> <span class="kc">None</span>   <span class="c1"># dict mapping str to BDDLEntity</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validate_goal</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">        Run sampling for this BEHAVIOR task</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">            validate_goal (bool): Whether the goal should be validated or not</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">            2-tuple:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">                - bool: Whether sampling was successful or not</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">                - None or str: None if successful, otherwise the associated error message</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Sampling task...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>        <span class="c1"># Reject scenes with missing non-sampleable objects</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>        <span class="c1"># Populate object_scope with sampleable objects and the robot</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>        <span class="n">accept_scene</span><span class="p">,</span> <span class="n">feedback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_scene_for_sampling</span><span class="p">()</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">accept_scene</span><span class="p">:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>            <span class="k">return</span> <span class="n">accept_scene</span><span class="p">,</span> <span class="n">feedback</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>        <span class="c1"># Sample objects to satisfy initial conditions</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>        <span class="n">accept_scene</span><span class="p">,</span> <span class="n">feedback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_all_conditions</span><span class="p">(</span><span class="n">validate_goal</span><span class="o">=</span><span class="n">validate_goal</span><span class="p">)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">accept_scene</span><span class="p">:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>            <span class="k">return</span> <span class="n">accept_scene</span><span class="p">,</span> <span class="n">feedback</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Sampling succeeded!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a>    <span class="k">def</span> <span class="nf">_sample_all_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validate_goal</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        Run sampling for this BEHAVIOR task</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">            validate_goal (bool): Whether the goal should be validated or not</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">            2-tuple:</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">                - bool: Whether sampling was successful or not</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">                - None or str: None if successful, otherwise the associated error message</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a>        <span class="c1"># Auto-initialize all sampleable objects</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>        <span class="k">with</span> <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">playing</span><span class="p">():</span>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a>            <span class="n">error_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_initial_conditions</span><span class="p">()</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a>            <span class="k">if</span> <span class="n">error_msg</span><span class="p">:</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a>                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">error_msg</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a>            <span class="k">if</span> <span class="n">validate_goal</span><span class="p">:</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a>                <span class="n">error_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_goal_conditions</span><span class="p">()</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a>                <span class="k">if</span> <span class="n">error_msg</span><span class="p">:</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a>                    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a>                    <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">error_msg</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>            <span class="n">error_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_initial_conditions_final</span><span class="p">()</span>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a>            <span class="k">if</span> <span class="n">error_msg</span><span class="p">:</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a>                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a>                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">error_msg</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_env</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">update_initial_state</span><span class="p">()</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a>        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a>    <span class="k">def</span> <span class="nf">_prepare_scene_for_sampling</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        Runs sanity checks for the current scene for the given BEHAVIOR task</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">            2-tuple:</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a><span class="sd">                - bool: Whether the generated scene activity should be accepted or not</span>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">                - dict: Any feedback from the sampling / initialization process</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a>        <span class="n">error_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_inroom_object_room_assignment</span><span class="p">()</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a>        <span class="k">if</span> <span class="n">error_msg</span><span class="p">:</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a>            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">error_msg</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a>        <span class="n">error_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_sampling_order</span><span class="p">()</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>        <span class="k">if</span> <span class="n">error_msg</span><span class="p">:</span>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a>            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">error_msg</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a>        <span class="n">error_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_inroom_object_scope</span><span class="p">()</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a>        <span class="k">if</span> <span class="n">error_msg</span><span class="p">:</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a>            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">error_msg</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a>        <span class="n">error_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_import_sampleable_objects</span><span class="p">()</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a>        <span class="k">if</span> <span class="n">error_msg</span><span class="p">:</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a>            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">error_msg</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="p">[</span><span class="s2">&quot;agent.n.01_1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BDDLEntity</span><span class="p">(</span><span class="n">bddl_inst</span><span class="o">=</span><span class="s2">&quot;agent.n.01_1&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_agent</span><span class="p">)</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a>        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a>    <span class="k">def</span> <span class="nf">_parse_inroom_object_room_assignment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        Infers which rooms each object is assigned to</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_room_type_to_object_instance</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_instances</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a>        <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_activity_conditions</span><span class="o">.</span><span class="n">parsed_initial_conditions</span><span class="p">:</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a>            <span class="k">if</span> <span class="n">cond</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;inroom&quot;</span><span class="p">:</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a>                <span class="n">obj_inst</span><span class="p">,</span> <span class="n">room_type</span> <span class="o">=</span> <span class="n">cond</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cond</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a>                <span class="n">obj_synset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_instance_to_synset</span><span class="p">[</span><span class="n">obj_inst</span><span class="p">]</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a>                <span class="n">abilities</span> <span class="o">=</span> <span class="n">OBJECT_TAXONOMY</span><span class="o">.</span><span class="n">get_abilities</span><span class="p">(</span><span class="n">obj_synset</span><span class="p">)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a>                <span class="k">if</span> <span class="s2">&quot;sceneObject&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">abilities</span><span class="p">:</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>                    <span class="c1"># Invalid room assignment</span>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a>                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;You have assigned room type for [</span><span class="si">{</span><span class="n">obj_synset</span><span class="si">}</span><span class="s2">], but [</span><span class="si">{</span><span class="n">obj_synset</span><span class="si">}</span><span class="s2">] is sampleable. &quot;</span> \
<a id="__codelineno-0-413" name="__codelineno-0-413"></a>                           <span class="sa">f</span><span class="s2">&quot;Only non-sampleable (scene) objects can have room assignment.&quot;</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a>                <span class="k">if</span> <span class="n">room_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">seg_map</span><span class="o">.</span><span class="n">room_sem_name_to_ins_name</span><span class="p">:</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a>                    <span class="c1"># Missing room type</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a>                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Room type [</span><span class="si">{</span><span class="n">room_type</span><span class="si">}</span><span class="s2">] missing in scene [</span><span class="si">{</span><span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">scene_model</span><span class="si">}</span><span class="s2">].&quot;</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>                <span class="k">if</span> <span class="n">room_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_room_type_to_object_instance</span><span class="p">:</span>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_room_type_to_object_instance</span><span class="p">[</span><span class="n">room_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_room_type_to_object_instance</span><span class="p">[</span><span class="n">room_type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj_inst</span><span class="p">)</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a>                <span class="k">if</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_instances</span><span class="p">:</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a>                    <span class="c1"># Duplicate room assignment</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a>                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Object [</span><span class="si">{</span><span class="n">obj_inst</span><span class="si">}</span><span class="s2">] has more than one room assignment&quot;</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_instances</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj_inst</span><span class="p">)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>        <span class="k">for</span> <span class="n">obj_synset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_activity_conditions</span><span class="o">.</span><span class="n">parsed_objects</span><span class="p">:</span>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a>            <span class="n">abilities</span> <span class="o">=</span> <span class="n">OBJECT_TAXONOMY</span><span class="o">.</span><span class="n">get_abilities</span><span class="p">(</span><span class="n">obj_synset</span><span class="p">)</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a>            <span class="k">if</span> <span class="s2">&quot;sceneObject&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">abilities</span><span class="p">:</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a>                <span class="k">continue</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a>            <span class="k">for</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_activity_conditions</span><span class="o">.</span><span class="n">parsed_objects</span><span class="p">[</span><span class="n">obj_synset</span><span class="p">]:</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a>                <span class="k">if</span> <span class="n">obj_inst</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_instances</span><span class="p">:</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a>                    <span class="c1"># Missing room assignment</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a>                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;All non-sampleable (scene) objects should have room assignment. [</span><span class="si">{</span><span class="n">obj_inst</span><span class="si">}</span><span class="s2">] does not have one.&quot;</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a>    <span class="k">def</span> <span class="nf">_build_sampling_order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">        Sampling orders is a list of lists: [[batch_1_inst_1, ... batch_1_inst_N], [batch_2_inst_1, batch_2_inst_M], ...]</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">        Sampling should happen for batch 1 first, then batch 2, so on and so forth</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">        Example: OnTop(plate, table) should belong to batch 1, and OnTop(apple, plate) should belong to batch 2</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a>        <span class="n">unsampleable_conditions</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a>        <span class="n">sampling_groups</span> <span class="o">=</span> <span class="p">{</span><span class="n">group</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;kinematic&quot;</span><span class="p">,</span> <span class="s2">&quot;particle&quot;</span><span class="p">,</span> <span class="s2">&quot;unary&quot;</span><span class="p">)}</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_object_sampling_conditions</span> <span class="o">=</span> <span class="p">{</span><span class="n">group</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;kinematic&quot;</span><span class="p">,</span> <span class="s2">&quot;particle&quot;</span><span class="p">,</span> <span class="s2">&quot;unary&quot;</span><span class="p">)}</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_object_sampling_orders</span> <span class="o">=</span> <span class="p">{</span><span class="n">group</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;kinematic&quot;</span><span class="p">,</span> <span class="s2">&quot;particle&quot;</span><span class="p">,</span> <span class="s2">&quot;unary&quot;</span><span class="p">)}</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_conditions</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a>        <span class="c1"># First, sort initial conditions into kinematic, particle and unary groups</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a>        <span class="c1"># bddl.condition_evaluation.HEAD, each with one child.</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a>        <span class="c1"># This child is either a ObjectStateUnaryPredicate/ObjectStateBinaryPredicate or</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>        <span class="c1"># a Negation of a ObjectStateUnaryPredicate/ObjectStateBinaryPredicate</span>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a>        <span class="k">for</span> <span class="n">condition</span> <span class="ow">in</span> <span class="n">get_initial_conditions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_activity_conditions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="p">):</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a>            <span class="n">condition</span><span class="p">,</span> <span class="n">positive</span> <span class="o">=</span> <span class="n">process_single_condition</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>            <span class="k">if</span> <span class="n">condition</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>                <span class="k">continue</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>            <span class="c1"># Sampled conditions must always be positive</span>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>            <span class="c1"># Non-positive (e.g.: NOT onTop) is not restrictive enough for sampling</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>            <span class="k">if</span> <span class="n">condition</span><span class="o">.</span><span class="n">STATE_NAME</span> <span class="ow">in</span> <span class="n">KINEMATIC_STATES_BDDL</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">positive</span><span class="p">:</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>                <span class="k">return</span> <span class="s2">&quot;Initial condition has negative kinematic conditions: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>            <span class="c1"># Store any unsampleable conditions separately</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">UnsampleablePredicate</span><span class="p">):</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                <span class="n">unsampleable_conditions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                <span class="k">continue</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>            <span class="c1"># Infer the group the condition and its object instances belong to</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>            <span class="c1"># (a) Kinematic (binary) conditions, where (ent0, ent1) are both objects</span>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>            <span class="c1"># (b) Particle (binary) conditions, where (ent0, ent1) are (object, substance)</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>            <span class="c1"># (d) Unary conditions, where (ent0,) is an object</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>            <span class="c1"># Binary conditions have length 2: (ent0, ent1)</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>                <span class="n">group</span> <span class="o">=</span> <span class="s2">&quot;particle&quot;</span> <span class="k">if</span> <span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substance_instances</span> <span class="k">else</span> <span class="s2">&quot;kinematic&quot;</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> \
<a id="__codelineno-0-476" name="__codelineno-0-476"></a>                    <span class="sa">f</span><span class="s2">&quot;Got invalid parsed initial condition; body length should either be 2 or 1. &quot;</span> \
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>                    <span class="sa">f</span><span class="s2">&quot;Got body: </span><span class="si">{</span><span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="si">}</span><span class="s2"> for condition: </span><span class="si">{</span><span class="n">condition</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a>                <span class="n">group</span> <span class="o">=</span> <span class="s2">&quot;unary&quot;</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a>            <span class="n">sampling_groups</span><span class="p">[</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_object_sampling_conditions</span><span class="p">[</span><span class="n">group</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">condition</span><span class="p">,</span> <span class="n">positive</span><span class="p">))</span>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a>            <span class="c1"># If the condition involves any non-sampleable object (e.g.: furniture), it&#39;s a non-sampleable condition</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a>            <span class="c1"># This means that there&#39;s no ordering constraint in terms of sampling, because we know the, e.g., furniture</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a>            <span class="c1"># object already exists in the scene and is placed, so these specific conditions can be sampled without</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a>            <span class="c1"># any dependencies</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_instances</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="p">)))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_conditions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">condition</span><span class="p">,</span> <span class="n">positive</span><span class="p">))</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a>        <span class="c1"># Now, sort each group, ignoring the futures (since they don&#39;t get sampled)</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a>        <span class="c1"># First handle kinematics, then particles, then unary</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a>        <span class="c1"># Start with the non-sampleable objects as the first sampled set, then infer recursively</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a>        <span class="n">cur_batch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_instances</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">cur_batch</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a>            <span class="n">next_batch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a>            <span class="k">for</span> <span class="n">cur_batch_inst</span> <span class="ow">in</span> <span class="n">cur_batch</span><span class="p">:</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>                <span class="n">inst_batch</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a>                <span class="k">for</span> <span class="n">condition</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_sampling_conditions</span><span class="p">[</span><span class="s2">&quot;kinematic&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a>                    <span class="k">if</span> <span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">cur_batch_inst</span><span class="p">:</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a>                        <span class="n">inst_batch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a>                        <span class="n">next_batch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inst_batch</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_object_sampling_orders</span><span class="p">[</span><span class="s2">&quot;kinematic&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inst_batch</span><span class="p">)</span>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a>            <span class="n">cur_batch</span> <span class="o">=</span> <span class="n">next_batch</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a>        <span class="c1"># Now parse particles -- simply unordered, since particle systems shouldn&#39;t impact each other</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_object_sampling_orders</span><span class="p">[</span><span class="s2">&quot;particle&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">cond</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">sampling_groups</span><span class="p">[</span><span class="s2">&quot;particle&quot;</span><span class="p">]})</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a>        <span class="n">sampled_particle_entities</span> <span class="o">=</span> <span class="p">{</span><span class="n">cond</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">sampling_groups</span><span class="p">[</span><span class="s2">&quot;particle&quot;</span><span class="p">]}</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a>        <span class="c1"># Finally, parse unaries -- this is simply unordered, since it is assumed that unary predicates do not</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a>        <span class="c1"># affect each other</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_object_sampling_orders</span><span class="p">[</span><span class="s2">&quot;unary&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">cond</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">sampling_groups</span><span class="p">[</span><span class="s2">&quot;unary&quot;</span><span class="p">]})</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a>        <span class="c1"># Aggregate future objects and any unsampleable obj instances</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a>        <span class="c1"># Unsampleable obj instances are strictly a superset of future obj instances</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>        <span class="n">unsampleable_obj_instances</span> <span class="o">=</span> <span class="p">{</span><span class="n">cond</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">unsampleable_conditions</span><span class="p">}</span>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_future_obj_instances</span> <span class="o">=</span> <span class="p">{</span><span class="n">cond</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">unsampleable_conditions</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">ObjectStateFuturePredicate</span><span class="p">)}</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a>        <span class="n">nonparticle_entities</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substance_instances</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a>        <span class="c1"># Sanity check kinematic objects -- any non-system must be kinematically sampled</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a>        <span class="n">remaining_kinematic_entities</span> <span class="o">=</span> <span class="n">nonparticle_entities</span> <span class="o">-</span> <span class="n">unsampleable_obj_instances</span> <span class="o">-</span> \
<a id="__codelineno-0-523" name="__codelineno-0-523"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_instances</span> <span class="o">-</span> <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_object_sampling_orders</span><span class="p">[</span><span class="s2">&quot;kinematic&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">set</span><span class="p">()]))</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">remaining_kinematic_entities</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Some objects do not have any kinematic condition defined for them in the initial conditions: &quot;</span> \
<a id="__codelineno-0-526" name="__codelineno-0-526"></a>                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">remaining_kinematic_entities</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="c1"># Sanity check particle systems -- any non-future system must be sampled as part of particle groups</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>        <span class="n">remaining_particle_entities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substance_instances</span> <span class="o">-</span> <span class="n">unsampleable_obj_instances</span> <span class="o">-</span> <span class="n">sampled_particle_entities</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">remaining_particle_entities</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Some systems do not have any particle condition defined for them in the initial conditions: &quot;</span> \
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>                   <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">remaining_particle_entities</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>    <span class="k">def</span> <span class="nf">_build_inroom_object_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="sd">        Store simulator object options for non-sampleable objects in self.inroom_object_scope</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="sd">        {</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a><span class="sd">            &quot;living_room&quot;: {</span>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">                &quot;table1&quot;: {</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">                    &quot;living_room_0&quot;: [URDFObject, URDFObject, URDFObject],</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">                    &quot;living_room_1&quot;: [URDFObject]</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a><span class="sd">                },</span>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">                &quot;table2&quot;: {</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">                    &quot;living_room_0&quot;: [URDFObject, URDFObject],</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">                    &quot;living_room_1&quot;: [URDFObject, URDFObject]</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">                },</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">                &quot;chair1&quot;: {</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">                    &quot;living_room_0&quot;: [URDFObject],</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">                    &quot;living_room_1&quot;: [URDFObject]</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">                },</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">            }</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">        }</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a>        <span class="n">room_type_to_scene_objs</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a>        <span class="k">for</span> <span class="n">room_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_room_type_to_object_instance</span><span class="p">:</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a>            <span class="n">room_type_to_scene_objs</span><span class="p">[</span><span class="n">room_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a>            <span class="k">for</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_room_type_to_object_instance</span><span class="p">[</span><span class="n">room_type</span><span class="p">]:</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a>                <span class="n">room_type_to_scene_objs</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">obj_inst</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>                <span class="n">obj_synset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_instance_to_synset</span><span class="p">[</span><span class="n">obj_inst</span><span class="p">]</span>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a>                <span class="c1"># We allow burners to be used as if they are stoves</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a>                <span class="n">categories</span> <span class="o">=</span> <span class="n">OBJECT_TAXONOMY</span><span class="o">.</span><span class="n">get_subtree_categories</span><span class="p">(</span><span class="n">obj_synset</span><span class="p">)</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a>                <span class="n">abilities</span> <span class="o">=</span> <span class="n">OBJECT_TAXONOMY</span><span class="o">.</span><span class="n">get_abilities</span><span class="p">(</span><span class="n">obj_synset</span><span class="p">)</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a>                <span class="c1"># Grab all models that fully support all abilities for the corresponding category</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a>                <span class="n">valid_models</span> <span class="o">=</span> <span class="p">{</span><span class="n">cat</span><span class="p">:</span> <span class="nb">set</span><span class="p">(</span><span class="n">get_all_object_category_models_with_abilities</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="n">abilities</span><span class="p">))</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>                                <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">}</span>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>                <span class="k">for</span> <span class="n">room_inst</span> <span class="ow">in</span> <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">seg_map</span><span class="o">.</span><span class="n">room_sem_name_to_ins_name</span><span class="p">[</span><span class="n">room_type</span><span class="p">]:</span>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a>                    <span class="c1"># A list of scene objects that satisfy the requested categories</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a>                    <span class="n">room_objs</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">object_registry</span><span class="p">(</span><span class="s2">&quot;in_rooms&quot;</span><span class="p">,</span> <span class="n">room_inst</span><span class="p">,</span> <span class="n">default_val</span><span class="o">=</span><span class="p">[])</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a>                    <span class="n">scene_objs</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">room_objs</span> <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">category</span> <span class="ow">in</span> <span class="n">categories</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">model</span> <span class="ow">in</span> <span class="n">valid_models</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">category</span><span class="p">]]</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">scene_objs</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a>                        <span class="n">room_type_to_scene_objs</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">obj_inst</span><span class="p">][</span><span class="n">room_inst</span><span class="p">]</span> <span class="o">=</span> <span class="n">scene_objs</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a>        <span class="n">error_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_consolidate_room_instance</span><span class="p">(</span><span class="n">room_type_to_scene_objs</span><span class="p">,</span> <span class="s2">&quot;initial_pre-sampling&quot;</span><span class="p">)</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a>        <span class="k">if</span> <span class="n">error_msg</span><span class="p">:</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a>            <span class="k">return</span> <span class="n">error_msg</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_scope</span> <span class="o">=</span> <span class="n">room_type_to_scene_objs</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a>    <span class="k">def</span> <span class="nf">_filter_object_scope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_object_scope</span><span class="p">,</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">condition_type</span><span class="p">):</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">        Filters the object scope based on given @input_object_scope, @conditions, and @condition_type</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">            input_object_scope (dict):</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">            conditions (list): List of conditions to filter scope with, where each list entry is</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">                a tuple of (condition, positive), where @positive is True if the condition has a positive</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">                evaluation.</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">            condition_type (str): What type of condition to sample, e.g., &quot;initial&quot;</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">            2-tuple:</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">                - dict: Filtered object scope</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">                - list of str: The name of children object(s) that have the highest proportion of kinematic sampling</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">                    failures</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>        <span class="n">filtered_object_scope</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a>        <span class="c1"># Maps child obj name (SCOPE name) to parent obj name (OBJECT name) to T / F,</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a>        <span class="c1"># ie: if the kinematic relationship was sampled successfully</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="n">problematic_objs</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="k">for</span> <span class="n">room_type</span> <span class="ow">in</span> <span class="n">input_object_scope</span><span class="p">:</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>            <span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>            <span class="k">for</span> <span class="n">scene_obj</span> <span class="ow">in</span> <span class="n">input_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">]:</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>                <span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">scene_obj</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>                <span class="k">for</span> <span class="n">room_inst</span> <span class="ow">in</span> <span class="n">input_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">scene_obj</span><span class="p">]:</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>                    <span class="c1"># These are a list of candidate simulator objects that need sampling test</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>                    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">input_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">scene_obj</span><span class="p">][</span><span class="n">room_inst</span><span class="p">]:</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>                        <span class="c1"># Temporarily set object_scope to point to this candidate object</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="p">[</span><span class="n">scene_obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">BDDLEntity</span><span class="p">(</span><span class="n">bddl_inst</span><span class="o">=</span><span class="n">scene_obj</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="n">obj</span><span class="p">)</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>                        <span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>                        <span class="c1"># If this candidate object is not involved in any conditions,</span>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>                        <span class="c1"># success will be True by default and this object will qualify</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>                        <span class="n">parent_obj_name</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>                        <span class="n">conditions_to_sample</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a>                        <span class="k">for</span> <span class="n">condition</span><span class="p">,</span> <span class="n">positive</span> <span class="ow">in</span> <span class="n">conditions</span><span class="p">:</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>                            <span class="c1"># Sample positive kinematic conditions that involve this candidate object</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a>                            <span class="k">if</span> <span class="n">condition</span><span class="o">.</span><span class="n">STATE_NAME</span> <span class="ow">in</span> <span class="n">KINEMATIC_STATES_BDDL</span> <span class="ow">and</span> <span class="n">positive</span> <span class="ow">and</span> <span class="n">scene_obj</span> <span class="ow">in</span> <span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="p">:</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a>                                <span class="n">child_scope_name</span> <span class="o">=</span> <span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a>                                <span class="n">entity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="p">[</span><span class="n">child_scope_name</span><span class="p">]</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a>                                <span class="n">conditions_to_sample</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">condition</span><span class="p">,</span> <span class="n">positive</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">child_scope_name</span><span class="p">))</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>                        <span class="c1"># Sort children based on their AABB so the larger objects are sampled first</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>                        <span class="n">conditions_to_sample</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">conditions_to_sample</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">aabb_extent</span><span class="p">)))</span>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>                        <span class="c1"># Sample!</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a>                        <span class="k">for</span> <span class="n">condition</span><span class="p">,</span> <span class="n">positive</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">child_scope_name</span> <span class="ow">in</span> <span class="n">conditions_to_sample</span><span class="p">:</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>                            <span class="n">success</span> <span class="o">=</span> <span class="n">condition</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">binary_state</span><span class="o">=</span><span class="n">positive</span><span class="p">)</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>                            <span class="n">log_msg</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>                                <span class="p">[</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>                                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">condition_type</span><span class="si">}</span><span class="s2"> kinematic condition sampling&quot;</span><span class="p">,</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a>                                    <span class="n">room_type</span><span class="p">,</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>                                    <span class="n">scene_obj</span><span class="p">,</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>                                    <span class="n">room_inst</span><span class="p">,</span>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>                                    <span class="n">parent_obj_name</span><span class="p">,</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>                                    <span class="n">condition</span><span class="o">.</span><span class="n">STATE_NAME</span><span class="p">,</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a>                                    <span class="nb">str</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="p">),</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>                                    <span class="nb">str</span><span class="p">(</span><span class="n">success</span><span class="p">),</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>                                <span class="p">]</span>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>                            <span class="p">)</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>                            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">log_msg</span><span class="p">)</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>                            <span class="c1"># Record the result for the child object</span>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>                            <span class="k">assert</span> <span class="n">parent_obj_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">problematic_objs</span><span class="p">[</span><span class="n">child_scope_name</span><span class="p">],</span> \
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>                                <span class="sa">f</span><span class="s2">&quot;Multiple kinematic relationships attempted for pair </span><span class="si">{</span><span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a>                            <span class="n">problematic_objs</span><span class="p">[</span><span class="n">child_scope_name</span><span class="p">][</span><span class="n">parent_obj_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">success</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>                            <span class="c1"># If any condition fails for this candidate object, skip</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>                            <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>                                <span class="k">break</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a>                        <span class="c1"># If this candidate object fails, move on to the next candidate object</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>                            <span class="k">continue</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>                        <span class="k">if</span> <span class="n">room_inst</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">scene_obj</span><span class="p">]:</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>                            <span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">scene_obj</span><span class="p">][</span><span class="n">room_inst</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>                        <span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">scene_obj</span><span class="p">][</span><span class="n">room_inst</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>        <span class="c1"># Compute most problematic objects</span>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>        <span class="n">problematic_objs_by_proportion</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a>        <span class="k">for</span> <span class="n">child_scope_name</span><span class="p">,</span> <span class="n">parent_obj_names</span> <span class="ow">in</span> <span class="n">problematic_objs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>            <span class="n">problematic_objs_by_proportion</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">parent_obj_names</span><span class="o">.</span><span class="n">values</span><span class="p">()))]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child_scope_name</span><span class="p">)</span>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a>        <span class="k">return</span> <span class="n">filtered_object_scope</span><span class="p">,</span> <span class="n">problematic_objs_by_proportion</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">problematic_objs_by_proportion</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a>    <span class="k">def</span> <span class="nf">_consolidate_room_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filtered_object_scope</span><span class="p">,</span> <span class="n">condition_type</span><span class="p">):</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">        Consolidates room instances</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a><span class="sd">            filtered_object_scope (dict): Filtered object scope</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a><span class="sd">            condition_type (str): What type of condition to sample, e.g., &quot;initial&quot;</span>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="sd">            None or str: Error message, if any</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="k">for</span> <span class="n">room_type</span> <span class="ow">in</span> <span class="n">filtered_object_scope</span><span class="p">:</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>            <span class="c1"># For each room_type, filter in room_inst that has successful</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>            <span class="c1"># sampling options for all obj_inst in this room_type</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>            <span class="n">room_inst_satisfied</span> <span class="o">=</span> <span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>                <span class="o">*</span><span class="p">[</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>                    <span class="nb">set</span><span class="p">(</span><span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">obj_inst</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>                    <span class="k">for</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">]</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>                <span class="p">]</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>            <span class="p">)</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">room_inst_satisfied</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>                <span class="n">error_msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">: Room type [</span><span class="si">{}</span><span class="s2">] of scene [</span><span class="si">{}</span><span class="s2">] do not contain or cannot sample all the objects needed.</span><span class="se">\n</span><span class="s2">The following are the possible room instances for each object, the intersection of which is an empty set.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>                    <span class="n">condition_type</span><span class="p">,</span> <span class="n">room_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scene_model</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>                <span class="p">)</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>                <span class="k">for</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">]:</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>                    <span class="n">error_msg</span> <span class="o">+=</span> <span class="p">(</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>                        <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">: &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj_inst</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">obj_inst</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>                    <span class="p">)</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>                <span class="k">return</span> <span class="n">error_msg</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>            <span class="k">for</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">]:</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>                <span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">obj_inst</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>                    <span class="n">key</span><span class="p">:</span> <span class="n">val</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a>                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">obj_inst</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">room_inst_satisfied</span>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a>                <span class="p">}</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a>    <span class="k">def</span> <span class="nf">_import_sampleable_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">        Import all objects that can be sampled</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a><span class="sd">            env (Environment): Current active environment instance</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a>        <span class="k">assert</span> <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">is_stopped</span><span class="p">(),</span> <span class="s2">&quot;Simulator should be stopped when importing sampleable objects&quot;</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a>        <span class="c1"># Move the robot object frame to a far away location, similar to other newly imported objects below</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_agent</span><span class="o">.</span><span class="n">set_position_orientation</span><span class="p">([</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sampled_objects</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a>        <span class="n">num_new_obj</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>        <span class="c1"># Only populate self.object_scope for sampleable objects</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="n">available_categories</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">get_all_object_categories</span><span class="p">())</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="k">for</span> <span class="n">obj_synset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_activity_conditions</span><span class="o">.</span><span class="n">parsed_objects</span><span class="p">:</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>            <span class="c1"># Don&#39;t populate agent</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>            <span class="k">if</span> <span class="n">obj_synset</span> <span class="o">==</span> <span class="s2">&quot;agent.n.01&quot;</span><span class="p">:</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>                <span class="k">continue</span>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>            <span class="c1"># Don&#39;t populate synsets that can&#39;t be sampled</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>            <span class="n">abilities</span> <span class="o">=</span> <span class="n">OBJECT_TAXONOMY</span><span class="o">.</span><span class="n">get_abilities</span><span class="p">(</span><span class="n">obj_synset</span><span class="p">)</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>            <span class="k">if</span> <span class="s2">&quot;sceneObject&quot;</span> <span class="ow">in</span> <span class="n">abilities</span><span class="p">:</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>                <span class="k">continue</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>            <span class="c1"># Populate based on whether it&#39;s a substance or not</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>            <span class="k">if</span> <span class="n">is_substance_synset</span><span class="p">(</span><span class="n">obj_synset</span><span class="p">):</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_activity_conditions</span><span class="o">.</span><span class="n">parsed_objects</span><span class="p">[</span><span class="n">obj_synset</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Systems are singletons&quot;</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>                <span class="n">obj_inst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_activity_conditions</span><span class="o">.</span><span class="n">parsed_objects</span><span class="p">[</span><span class="n">obj_synset</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>                <span class="n">system_name</span> <span class="o">=</span> <span class="n">OBJECT_TAXONOMY</span><span class="o">.</span><span class="n">get_subtree_categories</span><span class="p">(</span><span class="n">obj_synset</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="p">[</span><span class="n">obj_inst</span><span class="p">]</span> <span class="o">=</span> <span class="n">BDDLEntity</span><span class="p">(</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>                    <span class="n">bddl_inst</span><span class="o">=</span><span class="n">obj_inst</span><span class="p">,</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>                    <span class="n">entity</span><span class="o">=</span><span class="kc">None</span> <span class="k">if</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_future_obj_instances</span> <span class="k">else</span> <span class="n">get_system</span><span class="p">(</span><span class="n">system_name</span><span class="p">),</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>                <span class="p">)</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>                <span class="n">valid_categories</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">OBJECT_TAXONOMY</span><span class="o">.</span><span class="n">get_subtree_categories</span><span class="p">(</span><span class="n">obj_synset</span><span class="p">))</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>                <span class="n">categories</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">valid_categories</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">available_categories</span><span class="p">))</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;None of the following categories could be found in the dataset for synset </span><span class="si">{</span><span class="n">obj_synset</span><span class="si">}</span><span class="s2">: &quot;</span> \
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>                           <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">valid_categories</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>                <span class="k">for</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_activity_conditions</span><span class="o">.</span><span class="n">parsed_objects</span><span class="p">[</span><span class="n">obj_synset</span><span class="p">]:</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>                    <span class="c1"># Don&#39;t explicitly sample if future</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>                    <span class="k">if</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_future_obj_instances</span><span class="p">:</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="p">[</span><span class="n">obj_inst</span><span class="p">]</span> <span class="o">=</span> <span class="n">BDDLEntity</span><span class="p">(</span><span class="n">bddl_inst</span><span class="o">=</span><span class="n">obj_inst</span><span class="p">)</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>                        <span class="k">continue</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>                    <span class="n">category</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>                    <span class="c1"># Get all available models that support all of its synset abilities</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>                    <span class="n">model_choices</span> <span class="o">=</span> <span class="n">get_all_object_category_models_with_abilities</span><span class="p">(</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>                        <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>                        <span class="n">abilities</span><span class="o">=</span><span class="n">OBJECT_TAXONOMY</span><span class="o">.</span><span class="n">get_abilities</span><span class="p">(</span><span class="n">OBJECT_TAXONOMY</span><span class="o">.</span><span class="n">get_synset_from_category</span><span class="p">(</span><span class="n">category</span><span class="p">)),</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>                    <span class="p">)</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_choices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>                        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Missing valid object models for category: </span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>                    <span class="c1"># Randomly select an object model</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>                    <span class="n">model</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">model_choices</span><span class="p">)</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>                    <span class="c1"># create the object</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>                    <span class="n">simulator_obj</span> <span class="o">=</span> <span class="n">DatasetObject</span><span class="p">(</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>                        <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>                        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>                        <span class="n">fit_avg_dim_volume</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>                        <span class="n">prim_type</span><span class="o">=</span><span class="n">PrimType</span><span class="o">.</span><span class="n">CLOTH</span> <span class="k">if</span> <span class="s2">&quot;cloth&quot;</span> <span class="ow">in</span> <span class="n">OBJECT_TAXONOMY</span><span class="o">.</span><span class="n">get_abilities</span><span class="p">(</span><span class="n">obj_synset</span><span class="p">)</span> <span class="k">else</span> <span class="n">PrimType</span><span class="o">.</span><span class="n">RIGID</span><span class="p">,</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>                    <span class="p">)</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>                    <span class="n">num_new_obj</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>                    <span class="c1"># Load the object into the simulator</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>                    <span class="k">assert</span> <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">loaded</span><span class="p">,</span> <span class="s2">&quot;Scene is not loaded&quot;</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>                    <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">simulator_obj</span><span class="p">)</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>                    <span class="c1"># Set these objects to be far-away locations</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>                    <span class="n">simulator_obj</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">100.0</span><span class="p">])</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">num_new_obj</span> <span class="o">*</span> <span class="mf">5.0</span><span class="p">)</span>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_sampled_objects</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">simulator_obj</span><span class="p">)</span>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="p">[</span><span class="n">obj_inst</span><span class="p">]</span> <span class="o">=</span> <span class="n">BDDLEntity</span><span class="p">(</span><span class="n">bddl_inst</span><span class="o">=</span><span class="n">obj_inst</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="n">simulator_obj</span><span class="p">)</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>        <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a>        <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a>    <span class="k">def</span> <span class="nf">_sample_initial_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">        Sample initial conditions</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">            None or str: If successful, returns None. Otherwise, returns an error message</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a>        <span class="n">error_msg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_scope_filtered_initial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_conditions</span><span class="p">(</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_scope</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_conditions</span><span class="p">,</span> <span class="s2">&quot;initial&quot;</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>        <span class="p">)</span>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a>        <span class="k">return</span> <span class="n">error_msg</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a>    <span class="k">def</span> <span class="nf">_sample_goal_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">        Sample goal conditions</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">            None or str: If successful, returns None. Otherwise, returns an error message</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a>        <span class="n">activity_goal_conditions</span> <span class="o">=</span> <span class="n">get_goal_conditions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_activity_conditions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="p">)</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a>        <span class="n">ground_goal_state_options</span> <span class="o">=</span> <span class="n">get_ground_goal_state_options</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_activity_conditions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="p">,</span> <span class="n">activity_goal_conditions</span><span class="p">)</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a>        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">ground_goal_state_options</span><span class="p">)</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a>        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">((</span><span class="s2">&quot;number of ground_goal_state_options&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ground_goal_state_options</span><span class="p">)))</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a>        <span class="n">num_goal_condition_set_to_test</span> <span class="o">=</span> <span class="mi">10</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a>        <span class="n">goal_condition_success</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a>        <span class="c1"># Try to fulfill different set of ground goal conditions (maximum num_goal_condition_set_to_test)</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a>        <span class="k">for</span> <span class="n">goal_condition_set</span> <span class="ow">in</span> <span class="n">ground_goal_state_options</span><span class="p">[:</span><span class="n">num_goal_condition_set_to_test</span><span class="p">]:</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a>            <span class="n">goal_condition_processed</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a>            <span class="k">for</span> <span class="n">condition</span> <span class="ow">in</span> <span class="n">goal_condition_set</span><span class="p">:</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a>                <span class="n">condition</span><span class="p">,</span> <span class="n">positive</span> <span class="o">=</span> <span class="n">process_single_condition</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a>                <span class="k">if</span> <span class="n">condition</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>                    <span class="k">continue</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>                <span class="n">goal_condition_processed</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">condition</span><span class="p">,</span> <span class="n">positive</span><span class="p">))</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>            <span class="n">error_msg</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_conditions</span><span class="p">(</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_inroom_object_scope_filtered_initial</span><span class="p">,</span> <span class="n">goal_condition_processed</span><span class="p">,</span> <span class="s2">&quot;goal&quot;</span>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>            <span class="p">)</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">error_msg</span><span class="p">:</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>                <span class="c1"># if one set of goal conditions (and initial conditions) are satisfied, sampling is successful</span>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a>                <span class="n">goal_condition_success</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>                <span class="k">break</span>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">goal_condition_success</span><span class="p">:</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a>            <span class="k">return</span> <span class="n">error_msg</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>    <span class="k">def</span> <span class="nf">_sample_initial_conditions_final</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">        Sample final initial conditions</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">            None or str: If successful, returns None. Otherwise, returns an error message</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a>        <span class="c1"># Sample kinematics first, then particle states, then unary states</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a>        <span class="n">state</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">dump_state</span><span class="p">(</span><span class="n">serialized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a>        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;kinematic&quot;</span><span class="p">,</span> <span class="s2">&quot;particle&quot;</span><span class="p">,</span> <span class="s2">&quot;unary&quot;</span><span class="p">):</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sampling </span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="s2"> states...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_object_sampling_orders</span><span class="p">[</span><span class="n">group</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>                <span class="k">for</span> <span class="n">cur_batch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_sampling_orders</span><span class="p">[</span><span class="n">group</span><span class="p">]:</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>                    <span class="n">conditions_to_sample</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>                    <span class="k">for</span> <span class="n">condition</span><span class="p">,</span> <span class="n">positive</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_sampling_conditions</span><span class="p">[</span><span class="n">group</span><span class="p">]:</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>                        <span class="c1"># Sample conditions that involve the current batch of objects</span>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>                        <span class="n">child_scope_name</span> <span class="o">=</span> <span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a>                        <span class="k">if</span> <span class="n">child_scope_name</span> <span class="ow">in</span> <span class="n">cur_batch</span><span class="p">:</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>                            <span class="n">entity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="p">[</span><span class="n">child_scope_name</span><span class="p">]</span>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a>                            <span class="n">conditions_to_sample</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">condition</span><span class="p">,</span> <span class="n">positive</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">child_scope_name</span><span class="p">))</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a>                    <span class="c1"># If we&#39;re sampling kinematics, sort children based on their AABB, so that the larger objects</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a>                    <span class="c1"># are sampled first</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>                    <span class="k">if</span> <span class="n">group</span> <span class="o">==</span> <span class="s2">&quot;kinematic&quot;</span><span class="p">:</span>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a>                        <span class="n">conditions_to_sample</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">conditions_to_sample</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">aabb_extent</span><span class="p">)))</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a>                    <span class="c1"># Sample!</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a>                    <span class="k">for</span> <span class="n">condition</span><span class="p">,</span> <span class="n">positive</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="n">child_scope_name</span> <span class="ow">in</span> <span class="n">conditions_to_sample</span><span class="p">:</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a>                        <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a>                        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a>                            <span class="n">num_trials</span> <span class="o">=</span> <span class="mi">1</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a>                            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_trials</span><span class="p">):</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a>                                <span class="n">success</span> <span class="o">=</span> <span class="n">condition</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">binary_state</span><span class="o">=</span><span class="n">positive</span><span class="p">)</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a>                                <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a>                                    <span class="c1"># Update state</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a>                                    <span class="n">state</span> <span class="o">=</span> <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">dump_state</span><span class="p">(</span><span class="n">serialized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>                                    <span class="k">break</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>                            <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>                                <span class="c1"># Can terminate immediately</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>                                <span class="k">break</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>                            <span class="c1"># Can&#39;t re-sample non-kinematics or rescale cloth or agent, so in</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>                            <span class="c1"># those cases terminate immediately</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>                            <span class="k">if</span> <span class="n">group</span> <span class="o">!=</span> <span class="s2">&quot;kinematic&quot;</span> <span class="ow">or</span> <span class="s2">&quot;agent&quot;</span> <span class="ow">in</span> <span class="n">child_scope_name</span> <span class="ow">or</span> <span class="n">entity</span><span class="o">.</span><span class="n">prim_type</span> <span class="o">==</span> <span class="n">PrimType</span><span class="o">.</span><span class="n">CLOTH</span><span class="p">:</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>                                <span class="k">break</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>                            <span class="c1"># If any scales are equal or less than the lower threshold, terminate immediately</span>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a>                            <span class="n">new_scale</span> <span class="o">=</span> <span class="n">entity</span><span class="o">.</span><span class="n">scale</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">DYNAMIC_SCALE_INCREMENT</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a>                            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">new_scale</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">MIN_DYNAMIC_SCALE</span><span class="p">):</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a>                                <span class="k">break</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a>                            <span class="c1"># Re-scale and re-attempt</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a>                            <span class="c1"># Re-scaling is not respected unless sim cycle occurs</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a>                            <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a>                            <span class="n">entity</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">new_scale</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>                            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kinematic sampling </span><span class="si">{</span><span class="n">condition</span><span class="o">.</span><span class="n">STATE_NAME</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="si">}</span><span class="s2"> failed, rescaling obj: </span><span class="si">{</span><span class="n">child_scope_name</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">entity</span><span class="o">.</span><span class="n">scale</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a>                            <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a>                            <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">load_state</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">serialized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a>                            <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">step_physics</span><span class="p">()</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a>                            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Sampleable object conditions failed: </span><span class="si">{</span><span class="n">condition</span><span class="o">.</span><span class="n">STATE_NAME</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">condition</span><span class="o">.</span><span class="n">body</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>        <span class="c1"># One more sim step to make sure the object states are propagated correctly</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>        <span class="c1"># E.g. after sampling Filled.set_value(True), Filled.get_value() will become True only after one step</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>        <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>    <span class="k">def</span> <span class="nf">_sample_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_object_scope</span><span class="p">,</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">condition_type</span><span class="p">):</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a><span class="sd">        Sample conditions</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a><span class="sd">            input_object_scope (dict):</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a><span class="sd">            conditions (list): List of conditions to filter scope with, where each list entry is</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a><span class="sd">                a tuple of (condition, positive), where @positive is True if the condition has a positive</span>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a><span class="sd">                evaluation.</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a><span class="sd">            condition_type (str): What type of condition to sample, e.g., &quot;initial&quot;</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a><span class="sd">            None or str: If successful, returns None. Otherwise, returns an error message</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>        <span class="n">error_msg</span><span class="p">,</span> <span class="n">problematic_objs</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="p">[]</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>        <span class="k">while</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="p">[</span><span class="n">obj_inst</span><span class="p">]</span><span class="o">.</span><span class="n">scale</span> <span class="o">&lt;</span> <span class="n">m</span><span class="o">.</span><span class="n">MIN_DYNAMIC_SCALE</span><span class="p">)</span> <span class="k">for</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="n">problematic_objs</span><span class="p">]):</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>            <span class="n">filtered_object_scope</span><span class="p">,</span> <span class="n">problematic_objs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_object_scope</span><span class="p">(</span><span class="n">input_object_scope</span><span class="p">,</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">condition_type</span><span class="p">)</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>            <span class="n">error_msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_consolidate_room_instance</span><span class="p">(</span><span class="n">filtered_object_scope</span><span class="p">,</span> <span class="n">condition_type</span><span class="p">)</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>            <span class="k">if</span> <span class="n">error_msg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>                <span class="k">break</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>            <span class="c1"># Re-scaling is not respected unless sim cycle occurs</span>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>            <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a>            <span class="k">for</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="n">problematic_objs</span><span class="p">:</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>                <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="p">[</span><span class="n">obj_inst</span><span class="p">]</span>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a>                <span class="c1"># Can&#39;t rescale cloth or agent, so play again and then terminate immediately if found</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a>                <span class="k">if</span> <span class="s2">&quot;agent&quot;</span> <span class="ow">in</span> <span class="n">obj_inst</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">prim_type</span> <span class="o">==</span> <span class="n">PrimType</span><span class="o">.</span><span class="n">CLOTH</span><span class="p">:</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a>                    <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a>                    <span class="k">return</span> <span class="n">error_msg</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a>                <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">scale</span> <span class="o">&gt;</span> <span class="n">m</span><span class="o">.</span><span class="n">DYNAMIC_SCALE_INCREMENT</span><span class="p">)</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a>                <span class="n">obj</span><span class="o">.</span><span class="n">scale</span> <span class="o">-=</span> <span class="n">m</span><span class="o">.</span><span class="n">DYNAMIC_SCALE_INCREMENT</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a>            <span class="n">og</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>        <span class="k">if</span> <span class="n">error_msg</span><span class="p">:</span>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a>            <span class="k">return</span> <span class="n">error_msg</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_maximum_bipartite_matching</span><span class="p">(</span><span class="n">filtered_object_scope</span><span class="p">,</span> <span class="n">condition_type</span><span class="p">),</span> <span class="n">filtered_object_scope</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a>    <span class="k">def</span> <span class="nf">_maximum_bipartite_matching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filtered_object_scope</span><span class="p">,</span> <span class="n">condition_type</span><span class="p">):</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a><span class="sd">        Matches objects from @filtered_object_scope to specific room instances it can be</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a><span class="sd">        sampled from</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a><span class="sd">            filtered_object_scope (dict): Filtered object scope</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a><span class="sd">            condition_type (str): What type of condition to sample, e.g., &quot;initial&quot;</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a><span class="sd">        Returns:</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a><span class="sd">            None or str: If successful, returns None. Otherwise, returns an error message</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>        <span class="c1"># For each room instance, perform maximum bipartite matching between object instance in scope to simulator objects</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>        <span class="c1"># Left nodes: a list of object instance in scope</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="c1"># Right nodes: a list of simulator objects</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>        <span class="c1"># Edges: if the simulator object can support the sampling requirement of ths object instance</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="k">for</span> <span class="n">room_type</span> <span class="ow">in</span> <span class="n">filtered_object_scope</span><span class="p">:</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>            <span class="c1"># The same room instances will be shared across all scene obj in a given room type</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>            <span class="n">some_obj</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>            <span class="n">room_insts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">some_obj</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>            <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>            <span class="c1"># Loop through each room instance</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>            <span class="k">for</span> <span class="n">room_inst</span> <span class="ow">in</span> <span class="n">room_insts</span><span class="p">:</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>                <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>                <span class="c1"># For this given room instance, gether mapping from obj instance to a list of simulator obj</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>                <span class="n">obj_inst_to_obj_per_room_inst</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>                <span class="k">for</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">]:</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>                    <span class="n">obj_inst_to_obj_per_room_inst</span><span class="p">[</span><span class="n">obj_inst</span><span class="p">]</span> <span class="o">=</span> <span class="n">filtered_object_scope</span><span class="p">[</span><span class="n">room_type</span><span class="p">][</span><span class="n">obj_inst</span><span class="p">][</span><span class="n">room_inst</span><span class="p">]</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>                <span class="n">top_nodes</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>                <span class="n">log_msg</span> <span class="o">=</span> <span class="s2">&quot;MBM for room instance [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">room_inst</span><span class="p">)</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">((</span><span class="n">log_msg</span><span class="p">))</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>                <span class="k">for</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="n">obj_inst_to_obj_per_room_inst</span><span class="p">:</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>                    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">obj_inst_to_obj_per_room_inst</span><span class="p">[</span><span class="n">obj_inst</span><span class="p">]:</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>                        <span class="c1"># Create an edge between obj instance and each of the simulator obj that supports sampling</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>                        <span class="n">graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">obj_inst</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a>                        <span class="n">log_msg</span> <span class="o">=</span> <span class="s2">&quot;Adding edge: </span><span class="si">{}</span><span class="s2"> &lt;-&gt; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obj_inst</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>                        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">((</span><span class="n">log_msg</span><span class="p">))</span>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a>                        <span class="n">top_nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj_inst</span><span class="p">)</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a>                <span class="c1"># Need to provide top_nodes that contain all nodes in one bipartite node set</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a>                <span class="c1"># The matches will have two items for each match (e.g. A -&gt; B, B -&gt; A)</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>                <span class="n">matches</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">bipartite</span><span class="o">.</span><span class="n">maximum_matching</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">top_nodes</span><span class="o">=</span><span class="n">top_nodes</span><span class="p">)</span>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj_inst_to_obj_per_room_inst</span><span class="p">):</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a>                    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">((</span><span class="s2">&quot;Object scope finalized:&quot;</span><span class="p">))</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a>                    <span class="k">for</span> <span class="n">obj_inst</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">matches</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a>                        <span class="k">if</span> <span class="n">obj_inst</span> <span class="ow">in</span> <span class="n">obj_inst_to_obj_per_room_inst</span><span class="p">:</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_object_scope</span><span class="p">[</span><span class="n">obj_inst</span><span class="p">]</span> <span class="o">=</span> <span class="n">BDDLEntity</span><span class="p">(</span><span class="n">bddl_inst</span><span class="o">=</span><span class="n">obj_inst</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="n">obj</span><span class="p">)</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a>                            <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">((</span><span class="n">obj_inst</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a>                    <span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a>                    <span class="k">break</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a>                <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">: Room type [</span><span class="si">{}</span><span class="s2">] of scene [</span><span class="si">{}</span><span class="s2">] do not have enough simulator objects that can successfully sample all the objects needed. This is usually caused by specifying too many object instances in the object scope or the conditions are so stringent that too few simulator objects can satisfy them via sampling.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a>                    <span class="n">condition_type</span><span class="p">,</span> <span class="n">room_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scene_model</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a>                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 class="doc doc-heading" id="utils.bddl_utils.BDDLSampler.sample">
<code class="highlight language-python"><span class="n">sample</span><span class="p">(</span><span class="n">validate_goal</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Run sampling for this BEHAVIOR task</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>validate_goal</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether the goal should be validated or not</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2-tuple:
- bool: Whether sampling was successful or not
- None or str: None if successful, otherwise the associated error message</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>omnigibson/utils/bddl_utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-303" name="__codelineno-0-303"></a><span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validate_goal</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a><span class="sd">    Run sampling for this BEHAVIOR task</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="sd">        validate_goal (bool): Whether the goal should be validated or not</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        2-tuple:</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a><span class="sd">            - bool: Whether sampling was successful or not</span>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">            - None or str: None if successful, otherwise the associated error message</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Sampling task...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a>    <span class="c1"># Reject scenes with missing non-sampleable objects</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a>    <span class="c1"># Populate object_scope with sampleable objects and the robot</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a>    <span class="n">accept_scene</span><span class="p">,</span> <span class="n">feedback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_scene_for_sampling</span><span class="p">()</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">accept_scene</span><span class="p">:</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a>        <span class="k">return</span> <span class="n">accept_scene</span><span class="p">,</span> <span class="n">feedback</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a>    <span class="c1"># Sample objects to satisfy initial conditions</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a>    <span class="n">accept_scene</span><span class="p">,</span> <span class="n">feedback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_all_conditions</span><span class="p">(</span><span class="n">validate_goal</span><span class="o">=</span><span class="n">validate_goal</span><span class="p">)</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">accept_scene</span><span class="p">:</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a>        <span class="k">return</span> <span class="n">accept_scene</span><span class="p">,</span> <span class="n">feedback</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Sampling succeeded!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a>    <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 class="doc doc-heading" id="utils.bddl_utils.process_single_condition">
<code class="highlight language-python"><span class="n">process_single_condition</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Processes a single BDDL condition</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>condition</code></td>
          <td>
                <code>Condition</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Condition to process</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2-tuple:
- Expression: Condition's expression
- bool: Whether this evaluated condition is positive or negative</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>omnigibson/utils/bddl_utils.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="k">def</span> <span class="nf">process_single_condition</span><span class="p">(</span><span class="n">condition</span><span class="p">):</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    Processes a single BDDL condition</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">        condition (Condition): Condition to process</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">        2-tuple:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">            - Expression: Condition&#39;s expression</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">            - bool: Whether this evaluated condition is positive or negative</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Negation</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">AtomicFormula</span><span class="p">):</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">((</span><span class="s2">&quot;Skipping over sampling of predicate that is not a negation or an atomic formula&quot;</span><span class="p">))</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">condition</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Negation</span><span class="p">):</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">positive</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">condition</span> <span class="o">=</span> <span class="n">condition</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">positive</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="k">return</span> <span class="n">condition</span><span class="p">,</span> <span class="n">positive</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>


  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tracking", "navigation.tabs", "content.code.copy"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>